var Ht=Object.defineProperty;var Qt=(l,e,a)=>e in l?Ht(l,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[e]=a;var E=(l,e,a)=>Qt(l,typeof e!="symbol"?e+"":e,a);import{C as ee,I as Dt,B as P,b as te,f as Ie,A as Ot,i as Gt,s as J,a as F,j as Je,T as Oe,e as We,D as Yt,c as ce,E as je,k as Be,l as he,m as Xt,n as Kt,o as He,p as Nt,h as Zt,q as qt,r as ea,t as Ze,S as ta,d as aa,W as la}from"./error-ByG0LKAC.js";import{H as na,M as $e,S as g,J as Se,m as ae,K as sa,O as ra,P as ia,Q as oa,T as da,U as ca,A as Ae,ae as Me,X as ne,d as R,$ as se,r as v,b as X,G as ie,c as T,j as I,u as t,F as H,C as le,k as p,l as C,_ as Ve,o as c,V as be,f as h,I as s,al as ua,am as ot,x as ma,ac as Bt,ad as Fe,t as $,w as b,N as Te,i as U,L as Ne,a1 as Qe,a2 as Ge,B as et,z as bt,an as pa,y as At,g as K,h as Z,v as D,ao as A,a3 as ge,ap as va,aq as ga,ar as fa,as as ba,at as _a,au as _t,av as ht,aw as ha,ak as Ut,ax as fe,ay as ya,az as yt}from"./index-CI1TXeFk.js";import{_ as ka,D as L,f as wa,M as Le,b as V,B as Rt,c as Ye,e as Ca,p as tt,a as at,d as Sa,g as Ea,h as Ia,i as Va,C as $a,j as kt,k as Ta,w as xa}from"./index.vue_vue_type_style_index_0_scoped_f01006ee_lang-ijOL3OAg.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const qe=B(ka,[["__scopeId","data-v-113e3533"]]);class Da{constructor(e){E(this,"name",L.SelectWs);E(this,"getAccount");E(this,"listMyOrgs");E(this,"switchWs");this.getAccount=e.getAccount,this.listMyOrgs=e.listMyOrgs,this.switchWs=e.switchWs}}const ze=()=>{const l=na.getCached();if(!l)return 0;const e=$e.getWsp();if(!e)return g.handleError(Se.createWsNotFoundError()),0;const a=ae.getAccountCached();return a.successful?[...sa.listCached(),...ra.listCached(),...ia.listCached(),...oa.listCached(),...da.listCached(),...ca.listCached()].filter(r=>r.createdAt>=l.visitedAt).filter(r=>r.sbjWsId!==e.wsId&&r.sbjUid!==a.value.id).length:(g.handleErrorStackQuietly(a.errorStack),0)},Pt=B(wa,[["__scopeId","data-v-a02bba4a"]]),dt=async(l,e)=>{const a=await Ae.switchWs(l.wsId);return a.successful?(e&&await e(),setTimeout(()=>location.href=Me.buildPath()),ne.createSuccessful(void 0)):a},Oa={class:"bottom-nav"},Na={class:"bottom-nav__inner"},qa={key:0,class:"bottom-nav__inner__items"},Ba=["data-active","onClick"],Aa={key:0,class:"bottom-nav__inner__items__item"},Ua=R({__name:"bottom-nav",props:{account:{type:Object,required:!0}},setup(l){const e=se.getRouter(),a=se.getAppNav(),r=v(),i=v(0),m=()=>{i.value=ze()},n=()=>{V.push(new Da({getAccount:ae.getAccount,listMyOrgs:Ve.listMines,switchWs:dt}))},d=()=>{if(!a)return!1;const o=a.getCurrentRoute();return o.successful?o.value===Me:!1};return X(()=>{Le.subscribeToHomeEvent(m),r.value=$e.getWsp(),i.value=ze()}),ie(()=>{Le.unsubscribeFromHomeEvent(m)}),(o,u)=>(c(),T("div",Oa,[I("div",Na,[t(a)?(c(),T("div",qa,[(c(!0),T(H,null,le(t(a).getSideNavItems(),f=>(c(),T("button",{key:f.name,class:"bottom-nav__inner__items__item",style:be({"background-image":"url('"+f.iconSrc+"')"}),"data-active":t(a).isActive(f),onClick:()=>t(e).push(f.path)},[f===t(Me)&&i.value>0&&!d()?(c(),h(Pt,{key:0,class:"bottom-nav__inner__items__item__badge",text:i.value.toString(),color:t(Rt).Danger,size:t(ee).createXS()},null,8,["text","color","size"])):C("",!0)],12,Ba))),128)),r.value?(c(),T("div",Aa,[p(qe,{src:r.value.imgUrl,size:t(ee).createXS(),alt:t(s).workspaceOf(l.account.name),onClick:u[0]||(u[0]=()=>n())},null,8,["src","size","alt"])])):C("",!0)])):C("",!0)])]))}}),Ra=B(Ua,[["__scopeId","data-v-06190fc0"]]),Pa=R({__name:"border",props:{marginX:{type:Number,required:!1},margins:{type:Array,required:!1},color:{type:String,required:!1,default:ua},darkModeColor:{type:String,required:!1,default:ot}},setup(l){const e=l,a=()=>{let r=[0,0,0,0];return e.marginX&&(r[1]=e.marginX,r[3]=e.marginX),e.margins&&(r=e.margins),r.map(i=>`${i}px`).join(" ")};return(r,i)=>(c(),T("div",{class:"wrapper",style:be(`padding: ${a()};`)},[I("div",{class:"wrapper__border block-light",style:be({backgroundColor:l.color})},null,4),I("div",{class:"wrapper__border block-dark",style:be({backgroundColor:l.darkModeColor})},null,4)],4))}}),pt=B(Pa,[["__scopeId","data-v-6ff15189"]]);class Ma{constructor(e){E(this,"name",L.CreateOrg);E(this,"switchWs");E(this,"createOrg");E(this,"createPaymentMethod");E(this,"createPaymentSetupIntent");E(this,"fid","");E(this,"fidValidated");E(this,"orgName","");E(this,"orgNameValidated");E(this,"tel","");E(this,"telValidated");E(this,"pic","");E(this,"picValidated");E(this,"billingName","");E(this,"billingNameValidated");E(this,"billingCountryId","");E(this,"billingCountryIdValidated");E(this,"billingAddress","");E(this,"billingAddressValidated");E(this,"ccNumber","");E(this,"ccNumberValidated");E(this,"ccHolder","");E(this,"ccHolderValidated");E(this,"ccExpiration","");E(this,"ccExpirationValidated");E(this,"ccCvc","");E(this,"ccCvcValidated");this.switchWs=e.switchWs,this.createOrg=e.createOrg,this.createPaymentMethod=e.createPaymentMethod,this.createPaymentSetupIntent=e.createPaymentSetupIntent}}class Mt{constructor(e){E(this,"name",L.Confirmation);E(this,"typ");E(this,"title");E(this,"msg");E(this,"yesLabel");E(this,"noLabel");E(this,"onYes");E(this,"onNo");E(this,"closeByBtn");E(this,"confirmationTxt");this.typ=e.typ,this.title=e.title,this.msg=e.msg,this.yesLabel=e.yesLabel||s.yes(),this.noLabel=e.noLabel||s.no(),this.onYes=e.onYes,this.onNo=e.onNo,this.closeByBtn=e.closeByBtn??!1,this.confirmationTxt=e.confirmationTxt}}class Ft{constructor(e){E(this,"name",L.TransformAccount);E(this,"account");E(this,"requestOtp");E(this,"transformUser");this.account=e.account,this.requestOtp=e.requestOtp,this.transformUser=e.transformUser}}const wt=async()=>{const l=await ae.logOut();if(!l.successful){g.handleErrorStack(l.errorStack,s.failedToLogOut());return}window.location.href=ma.path},Fa=()=>{const l=ae.getAccountCached();if(!l.successful){g.handleErrorStack(l.errorStack,s.failedToLogOut());return}l.value.isGuest?V.push(new Mt({typ:Ye.Warning,title:s.warning(),msg:s.warningAboutLoggingOutOfGuestAccount(),onYes:wt,onNo:()=>V.pop()})):wt()},xe=class xe{};E(xe,"create",async()=>{const e=await Bt.post(xe.path,{});if(!e.successful||!e.value.ok)return Fe.createFailed({clientSecret:""},e.value,e.errorStack);const a=await e.value.json();return Fe.createSuccessful(a,e.value)}),E(xe,"path","/payment-setup-intents");let ct=xe;const La=["data-has-wss","data-is-guest"],za={class:"side-nav__wss"},Ja={key:0,class:"side-nav__wss__ws"},Wa=["data-active"],ja=["data-active"],Ha={class:"side-nav__wss__ws"},Qa={class:"side-nav__menu"},Ga={key:0,class:"side-nav__menu__main"},Ya={class:"side-nav__menu__main__ws-name"},Xa=["data-active"],Ka={key:0,class:"side-nav__menu__main__actions"},Za={class:"side-nav__bottom"},el=R({__name:"side-nav",props:{isGuest:{type:Boolean,required:!1,default:!1}},setup(l){const e=se.getRouter(),a=se.getAppNav(),r=v(),i=v([]),m=v(),n=v(0),d=_=>{r.value=_},o=_=>{i.value=_},u=_=>{m.value=_},f=()=>{var _;m.value||g.handleErrorQuietly(Se.createAccountNotFoundError()),(_=m.value)!=null&&_.isGuest?V.push(new Mt({typ:Ye.Default,title:s.registerBusiness(),msg:s.youNeedToRegisterToProceed(),yesLabel:s.register(),noLabel:s.cancel(),onYes:()=>{if(V.pop(),!m.value){g.handleErrorQuietly(Se.createAccountNotFoundError());return}V.push(new Ft({account:m.value,requestOtp:Ae.requestOtp,transformUser:ae.transform}))},onNo:()=>V.pop()})):V.push(new Ma({switchWs:dt,createOrg:Ve.create,createPaymentMethod:Ca.create,createPaymentSetupIntent:ct.create}))},S=()=>{ae.getWs().then(_=>{if(!_.successful){g.handleErrorStack(_.errorStack,s.failedToFetchData());return}window.location.href=Te.buildCreatorUrl(_.value.fid)})},y=async _=>{const x=await dt(_);if(!x.successful){g.handleErrorStack(x.errorStack);return}},k=()=>{n.value=ze()};return X(()=>{$e.subscribeToWsChangeEvent(d),Ve.subscribeToMinesChangeEvent(o),ae.subscribeToAccountChangeEvent(u),Le.subscribeToHomeEvent(k),r.value=$e.getWsp(),ae.getAccount().then(_=>{if(!_.successful){g.handleErrorStack(_.errorStack,s.failedToFetchData());return}m.value=_.value}),Ve.listMines().then(_=>{if(!_.successful){g.handleErrorStack(_.errorStack,s.failedToFetchData());return}i.value=_.value}),n.value=ze()}),ie(()=>{$e.unsubscribeFromWsChangeEvent(d),Ve.unsubscribeFromMinesChangeEvent(o),ae.unsubscribeFromAccountChangeEvent(u),Le.unsubscribeFromHomeEvent(k)}),(_,x)=>{var O,q;return c(),T("div",{class:"side-nav","data-has-wss":i.value.length>0,"data-is-guest":l.isGuest},[I("div",za,[m.value?(c(),T("div",Ja,[I("div",{class:"side-nav__wss__ws__frame","data-active":m.value.wsId===((O=r.value)==null?void 0:O.wsId)},[p(qe,{class:"side-nav__wss__ws__frame__btn",src:m.value.imgUrl,size:t(ee).createXS(),alt:t(s).workspaceOf(m.value.name),onClick:x[0]||(x[0]=()=>y(m.value))},null,8,["src","size","alt"])],8,Wa)])):C("",!0),(c(!0),T(H,null,le(i.value,w=>{var N;return c(),T("div",{key:w.id,class:"side-nav__wss__ws"},[I("div",{class:"side-nav__wss__ws__frame","data-active":w.wsId===((N=r.value)==null?void 0:N.wsId)},[p(qe,{class:"side-nav__wss__ws__frame__btn",src:w.imgUrl,size:t(ee).createXS(),alt:t(s).workspaceOf(w.name),onClick:()=>y(w)},null,8,["src","size","alt","onClick"])],8,ja)])}),128)),I("div",Ha,[p(Dt,{class:"side-nav__wss__ws__btn",src:"/icon/add-light-black.svg","dark-src":"/icon/add-silver.svg",alt:t(s).registerBusiness(),onClick:f},null,8,["alt"])])]),I("div",Qa,[t(a)?(c(),T("div",Ga,[I("div",Ya,$(((q=r.value)==null?void 0:q.name)||""),1),(c(!0),T(H,null,le(t(a).getSideNavItems(),w=>(c(),T("div",{key:w.name,class:"side-nav__menu__main__nav-item","data-active":t(a).isActive(w)},[p(P,{"head-icon":{src:w.iconSrc,darkSrc:w.darkIconSrc},active:t(a).isActive(w),theme:t(te).Text,"text-btn-underline-when":t(Ie).Never,"wide-icon-gap":!0,"align-h":t(Ot).Left,"expand-h":!0,class:"side-nav__menu__main__nav-item__btn",onClick:()=>t(e).push(w.path)},{default:b(()=>[U($(w.getLabel()),1)]),_:2},1032,["head-icon","active","theme","text-btn-underline-when","align-h","onClick"]),w===t(Me)&&n.value>0?(c(),h(Pt,{key:0,text:n.value.toString(),color:t(Rt).Danger,size:t(ee).createS()},null,8,["text","color","size"])):C("",!0)],8,Xa))),128)),r.value?(c(),T("div",Ka,[r.value.isUser?(c(),h(P,{key:0,class:"side-nav__menu__main__actions__item","head-icon":{src:"/icon/add-light-black.svg",darkSrc:"/icon/add-silver.svg"},theme:t(te).Text,"text-btn-underline-when":t(Ie).Never,onClick:f},{default:b(()=>[U($(t(s).registerBusiness()),1)]),_:1},8,["theme","text-btn-underline-when"])):r.value.isOrg?(c(),h(P,{key:1,class:"side-nav__menu__main__actions__item","head-icon":{src:"/icon/architecture-light-black.svg",darkSrc:"/icon/architecture-silver.svg"},theme:t(te).Text,"text-btn-underline-when":t(Ie).Never,onClick:S},{default:b(()=>[U($(t(s).creatorPage()),1)]),_:1},8,["theme","text-btn-underline-when"])):C("",!0)])):C("",!0)])):C("",!0),I("div",Za,[p(pt,{class:"side-nav__menu__main__border",margins:[0,15,0,5]}),p(P,{"head-icon":{src:"/icon/logout-light-black.svg",darkSrc:"/icon/logout-silver.svg"},theme:t(te).Text,"text-btn-underline-when":t(Ie).Never,class:"side-nav__bottom__nav-item",onClick:t(Fa)},{default:b(()=>[U($(t(s).logOut()),1)]),_:1},8,["theme","text-btn-underline-when","onClick"])])])],8,La)}}}),tl=B(el,[["__scopeId","data-v-be028c80"]]),al=["src","alt","data-size","data-clickable"],ll=R({__name:"index",props:{thumbnail:{type:Object,required:!0}},setup(l){return(e,a)=>(c(),T("div",{key:l.thumbnail.id,class:"thumbnail"},[I("img",{class:"thumbnail__img",src:l.thumbnail.src,alt:l.thumbnail.alt,"data-size":l.thumbnail.size?l.thumbnail.size.val:t(Gt).S,"data-clickable":l.thumbnail.onClick!==void 0,onClick:a[0]||(a[0]=(...r)=>l.thumbnail.onClick&&l.thumbnail.onClick(...r))},null,8,al)]))}}),nl=B(ll,[["__scopeId","data-v-cbb6fc94"]]),sl={class:"thumbnails"},rl=R({__name:"index",props:{thumbnails:{type:Array,required:!0}},setup(l){return(e,a)=>(c(),T("div",sl,[(c(!0),T(H,null,le(l.thumbnails,r=>(c(),h(nl,{key:r.id,thumbnail:r,class:"thumbnails__item"},null,8,["thumbnail"]))),128))]))}}),Lt=B(rl,[["__scopeId","data-v-6213e781"]]);class Ce{static clone(e){const a=[];return e.forEach(r=>a.push(r)),Ne.debug(`test element equality: ${e[0]===a[0]}`),a}static toMap(e,a){const r=new Map;return e.forEach(i=>{r.set(i[a].toString(),i)}),r}static toHash(e,a){const r={};return e.forEach(i=>{r[i[a]]=i}),r}}E(Ce,"removeUndefined",e=>e.filter(a=>a!==void 0));const il="/icon/dark-mode.svg",ol="/icon/light-mode.svg",dl=l=>(Qe("data-v-2bb8bf66"),l=l(),Ge(),l),cl=dl(()=>I("div",{class:"toggle-btn__head flex-center"},[I("img",{class:"block-dark",src:il,alt:""}),I("img",{class:"block-light",src:ol,alt:""})],-1)),ul=[cl],ml=R({__name:"index",setup(l){const e=v(null),a=()=>document.body.dataset.dark==="true",r=i=>{const m=!a();se.isDarkMode=m,document.body.dataset.animation="true",setTimeout(()=>{document.body.dataset.dark=m.toString(),setTimeout(()=>document.body.dataset.animation="false",250)}),i.target&&(i.target.dataset.animation="true",setTimeout(()=>{i.target.dataset.right=m.toString(),setTimeout(()=>i.target.dataset.animation="false",250)}))};return X(()=>{if(e.value==null){g.handleError(Se.createUiError("toggleBtn is null"));return}e.value.dataset.right=a().toString()}),(i,m)=>(c(),T("button",{class:"toggle-btn dark-mode",ref_key:"toggleBtn",ref:e,onClick:r},ul,512))}}),pl=B(ml,[["__scopeId","data-v-2bb8bf66"]]),vl={class:"right-bar"},gl={key:0,class:"right-bar__section right-bar__section--rv-products"},fl={class:"right-bar__section__sub-title"},bl={key:1,class:"right-bar__section right-bar__section--rv-discussions"},_l={class:"right-bar__section__sub-title"},hl={class:"right-bar__section--rv-discussions__body"},yl=["href"],kl={key:2,class:"right-bar__section right-bar__section--followed-discussions"},wl={class:"right-bar__section__sub-title"},Cl={class:"right-bar__section--followed-discussions__body"},Sl=["to"],El={class:"right-bar__section right-bar__section--bottom"},Il=R({__name:"right-bar",props:{zen:{type:Boolean,required:!1,default:!1}},setup(l){const e=v([]),a=v([]),r=v([]),i=async()=>{const d=await tt.list();if(!d.successful){g.handleErrorStackQuietly(d.errorStack);return}if(d.value.length===0){e.value=[];return}const o=await et.listByIds(d.value.map(f=>f.pid));if(!o.successful){g.handleErrorStackQuietly(o.errorStack);return}const u=Ce.toMap(o.value,"id");e.value=d.value.sort((f,S)=>S.visitedAt>f.visitedAt?1:-1).map(f=>{const S=u.get(f.pid.toString());return S?{id:String(S.id),src:S.imgUrl,alt:S.name,onClick:()=>window.location.href=Te.buildProductUrl(S.wsFid,S.fid)}:null}).filter(f=>f!==null)},m=async()=>{const d=await Sa.listMine();if(!d.successful){g.handleErrorStackQuietly(d.errorStack);return}if(d.value.length===0){a.value=[];return}const o=await bt.listByIds(d.value.map(y=>y.did));if(!o.successful){g.handleErrorStackQuietly(o.errorStack);return}const u=Ce.toMap(o.value,"id"),f=await et.listByIds(o.value.map(y=>y.pid));if(!f.successful){g.handleErrorStackQuietly(f.errorStack);return}const S=Ce.toMap(f.value,"id");a.value=d.value.sort((y,k)=>k.visitedAt>y.visitedAt?1:-1).map(y=>{const k=u.get(y.did.toString());if(!k)return null;const _=S.get(k.pid.toString());return _?{url:Te.buildDiscussionUrl(_.wsFid,_.fid,k.id),title:k.title}:null}).filter(y=>y!==null)},n=async()=>{const d=await at.list();if(!d.successful){g.handleErrorStackQuietly(d.errorStack);return}if(d.value.length===0){r.value=[];return}const o=await bt.listByIds(d.value.map(y=>y.did));if(!o.successful){g.handleErrorStackQuietly(o.errorStack);return}const u=Ce.toMap(o.value,"id"),f=await et.listByIds(o.value.map(y=>y.pid));if(!f.successful){g.handleErrorStackQuietly(f.errorStack);return}const S=Ce.toMap(f.value,"id");r.value=d.value.sort((y,k)=>k.createdAt>y.createdAt?1:-1).map(y=>{const k=u.get(y.did.toString());if(!k)return null;const _=S.get(k.pid.toString());return _?{url:Te.buildDiscussionUrl(_.wsFid,_.fid,k.id),title:k.title}:null}).filter(y=>y!==null)};return X(()=>{tt.subscribeToEvent(i),at.subscribeToEvent(n),i(),m(),n()}),ie(()=>{tt.unsubscribeFromEvent(i),at.unsubscribeFromEvent(n)}),(d,o)=>(c(),T("div",vl,[l.zen?C("",!0):(c(),T(H,{key:0},[e.value.length>0?(c(),T("div",gl,[I("p",fl,$(t(s).recentlyViewedProducts()),1),p(Lt,{thumbnails:e.value},null,8,["thumbnails"])])):C("",!0),a.value.length>0?(c(),T("div",bl,[I("p",_l,$(t(s).recentlyViewedDiscussions()),1),I("div",hl,[(c(!0),T(H,null,le(a.value,u=>(c(),T("a",{key:u.url,href:u.url,class:"right-bar__section--rv-discussions__body__link"},$(u.title),9,yl))),128))])])):C("",!0),r.value.length>0?(c(),T("div",kl,[I("p",wl,$(t(s).followedDiscussions()),1),I("div",Cl,[(c(!0),T(H,null,le(r.value,u=>(c(),T("a",{key:u.url,to:u.url,class:"right-bar__section--followed-discussions__body__link"},$(u.title),9,Sl))),128))])])):C("",!0)],64)),I("div",El,[p(pl)])]))}}),Vl=B(Il,[["__scopeId","data-v-a97edec4"]]),Ct="temp",St="temp-svg";class de{static appendToTemp(e){const a=document.getElementById(Ct);a&&a.appendChild(e)}static appendSvgElemToTemp(e){const a=document.getElementById(St);a&&a.appendChild(e)}static removeFromTemp(e){const a=document.getElementById(Ct);a&&a.removeChild(e)}static removeSvgElemFromTemp(e){const a=document.getElementById(St);a&&a.removeChild(e)}static appendToBody(e){document.body.appendChild(e)}static removeFromBody(e){document.body.removeChild(e)}static calcElemDimensions(e){const a=e.cloneNode(!0);de.appendToTemp(a);const r=a.offsetWidth,i=a.offsetHeight;return de.removeFromTemp(a),{width:r,height:i}}static calcSvgElemDimensions(e){const a=e.cloneNode(!0);de.appendSvgElemToTemp(a);const r=a.scrollWidth,i=a.scrollHeight;return de.removeSvgElemFromTemp(a),{width:r,height:i}}static calcSidePanelWidth(e){return Math.max(window.innerWidth-e.clientX,pa)}}const G=B(Ea,[["__scopeId","data-v-d830fbf4"]]),Q=B(Ia,[["__scopeId","data-v-ba535d33"]]),$l={class:"body"},Tl={class:"body__txt"},xl={key:0,class:"body__form"},Dl="confirmation-dialog",Ol=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=v(""),a=v();return(r,i)=>(c(),h(G,{type:l.ctrl.typ,title:l.ctrl.title,"close-by-btn":l.ctrl.closeByBtn,onClose:i[2]||(i[2]=()=>t(V).pop())},{default:b(()=>[I("div",$l,[I("p",Tl,$(l.ctrl.msg),1),l.ctrl.confirmationTxt?(c(),T("div",xl,[p(F,{id:Dl+"-confirmation-txt",class:"body__form__input",modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=m=>e.value=m),placeholder:t(s).typeX(l.ctrl.confirmationTxt),secure:!0,spec:t(J),onValidated:i[1]||(i[1]=m=>a.value=m)},null,8,["id","modelValue","placeholder","spec"])])):C("",!0),p(Q,{class:"body__btn-group"},{default:b(()=>[l.ctrl.onYes?(c(),h(P,{key:0,onClick:l.ctrl.onYes,fat:!0,theme:l.ctrl.typ===t(Ye).Warning?t(te).Danger:t(te).Primary,disabled:l.ctrl.confirmationTxt!==void 0&&l.ctrl.confirmationTxt!==e.value},{default:b(()=>[U($(l.ctrl.yesLabel),1)]),_:1},8,["onClick","theme","disabled"])):C("",!0),l.ctrl.onNo?(c(),h(P,{key:1,onClick:l.ctrl.onNo,fat:!0,theme:t(te).Plain},{default:b(()=>[U($(l.ctrl.noLabel),1)]),_:1},8,["onClick","theme"])):C("",!0)]),_:1})])]),_:1},8,["type","title","close-by-btn"]))}}),Nl=B(Ol,[["__scopeId","data-v-057ac636"]]),ql={},Bl={class:"form"};function Al(l,e){return c(),T("div",Bl,[At(l.$slots,"default",{},void 0,!0)])}const re=B(ql,[["render",Al],["__scopeId","data-v-c04a24c0"]]);class zt{constructor(e,a=!1){E(this,"name",L.CropImg);E(this,"subscribers",[]);this.srcUrl=e,this.enableCaption=a}subscribeToCropEvent(e){this.subscribers.push(e)}unsubscribeFromCropEvent(e){this.subscribers=this.subscribers.filter(a=>a!==e)}publishCropEvent(e){this.subscribers.forEach(a=>a(e))}}const Ul={class:"img-input"},Rl={key:0,class:"img-input__label"},Pl=["for"],Ml={class:"img-input__input"},Fl=["for","data-invalid","data-focused"],Ll=["id"],zl=R({__name:"index",props:{id:{type:String,required:!0},label:{type:String,required:!1,default:""},src:{type:String,required:!0},alt:{type:String,required:!0,default:""},spec:{type:Object,required:!0}},emits:["input","validated"],setup(l,{emit:e}){const a=l,r=v(!1),i=v(),m=v(),n=v(),d=e,o=S=>{n.value=a.spec.isSatisfiedBy(S),d("validated",n.value)},u=S=>{if(console.log("getCropResultIfAny"),!S.src){g.handleError(new Error("cropped image is null"));return}m.value&&URL.revokeObjectURL(m.value),m.value=URL.createObjectURL(S.src),o(S.src),d("input",S.src)},f=S=>{const y=S.target.files,k=y==null?void 0:y.item(0);if(!k){g.handleError(new Error("file is null"));return}i.value&&URL.revokeObjectURL(i.value),i.value=URL.createObjectURL(k);const _=new zt(i.value);_.subscribeToCropEvent(u),V.push(_),S.target.value=""};return(S,y)=>(c(),T("div",Ul,[l.label?(c(),T("div",Rl,[I("label",{class:"img-input__label__txt",for:l.id},$(l.label),9,Pl)])):C("",!0),I("div",Ml,[I("label",{class:"img-input__input__label",for:l.id,style:be({backgroundImage:`url(${m.value||l.src})`}),"data-invalid":n.value&&!n.value.isSatisfied,"data-focused":r.value},null,12,Fl),I("input",{id:l.id,class:"img-input__input__input",type:"file",accept:"image/*",onChange:f,onFocus:y[0]||(y[0]=k=>r.value=!0),onBlur:y[1]||(y[1]=k=>r.value=!1)},null,40,Ll)]),n.value&&n.value.errorMsg?(c(),h(Je,{key:1,msg:n.value.errorMsg},null,8,["msg"])):C("",!0)]))}}),Xe=B(zl,[["__scopeId","data-v-6227c5a2"]]);class Jl{constructor(e){E(this,"name",L.LogIn);E(this,"requestOtp");E(this,"logIn");this.requestOtp=e.requestOtp,this.logIn=e.logIn}}const ve="register-dialog",Wl=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(""),r=v(),i=v(""),m=v(),n=v(""),d=v(),o=v(!1),u=()=>ce([r.value,m.value,...o.value?[d.value]:[]]),f=()=>{o.value=!1,n.value="",d.value=void 0},S=async()=>{const O=i.value.trim(),q=await e.ctrl.requestOtp(O);if(!q.successful){g.handleErrorStack(q.errorStack,s.failedToRequestOtp());return}o.value=!0,K.add(Z.createSuccess(s.otpHasBeenSentTo(O)))},y=Oe.create({iconSrc:"/icon/refresh-light-black.svg",darkIconSrc:"/icon/refresh-silver.svg",onClick:S}),k=async()=>{const O=await e.ctrl.register(i.value.trim(),n.value.trim(),a.value.trim(),a.value.trim(),D.langCode);if(!O.successful){g.handleErrorStack(O.errorStack,O.errorStack.hasHttpError({targetErrRespCode:je.ErrRespCodeInvalidOtp})?s.invalidOtp():s.failedToRegister());return}V.pop()},_=()=>{V.pop(),V.push(new Jl({requestOtp:Ae.requestOtp,logIn:ae.logIn}))},x=async()=>{const O=await e.ctrl.guestLogIn(D.langCode);if(!O.successful){g.handleErrorStack(O.errorStack,s.failedToLogIn());return}V.pop()};return(O,q)=>(c(),h(G,{title:t(s).register(),"close-by-btn":!0,onClose:q[6]||(q[6]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"contents__form"},{default:b(()=>[p(F,{id:ve+"__username",label:t(s).username(),"err-msg":"",modelValue:a.value,"onUpdate:modelValue":q[0]||(q[0]=w=>a.value=w),spec:t(J),onValidated:q[1]||(q[1]=w=>r.value=w)},null,8,["id","label","modelValue","spec"]),p(F,{id:ve+"__email",label:t(s).email(),"err-msg":"",modelValue:i.value,"onUpdate:modelValue":q[2]||(q[2]=w=>i.value=w),spec:t(We),onValidated:q[3]||(q[3]=w=>m.value=w),onInput:f},null,8,["id","label","modelValue","spec"]),o.value?(c(),h(F,{key:0,id:ve+"__otp",label:t(s).otp(),"tail-btn":t(y),modelValue:n.value,"onUpdate:modelValue":q[4]||(q[4]=w=>n.value=w),spec:t(J),onValidated:q[5]||(q[5]=w=>d.value=w)},null,8,["id","label","tail-btn","modelValue","spec"])):C("",!0),p(Q,null,{default:b(()=>[o.value?C("",!0):(c(),h(P,{key:0,id:`${ve}__send-otp`,size:t(ee).createL(),disabled:!u(),onClick:S},{default:b(()=>[U($(t(s).requestOtp()),1)]),_:1},8,["id","size","disabled"])),o.value?(c(),h(P,{key:1,id:`${ve}__register`,size:t(ee).createL(),disabled:!u(),onClick:k},{default:b(()=>[U($(t(s).register()),1)]),_:1},8,["id","size","disabled"])):C("",!0)]),_:1})]),_:1}),p(pt,{margins:[30,0,30,0]}),p(Q,{direction:t(Yt).Column,"tight-gap":!0},{default:b(()=>[p(P,{id:`${ve}__log-in`,size:t(ee).createM(),theme:t(te).Text,onClick:_},{default:b(()=>[U($(t(s).logInWithYourAccount()),1)]),_:1},8,["id","size","theme"]),p(P,{class:"log-in__guest-btn",id:`${ve}__guest`,size:t(ee).createM(),theme:t(te).Text,onClick:x},{default:b(()=>[U($(t(s).continueAsGuest()),1)]),_:1},8,["id","size","theme"])]),_:1},8,["direction"])]),_:1},8,["title"]))}}),jl=B(Wl,[["__scopeId","data-v-99b34bcb"]]);class Hl{constructor(e){E(this,"name",L.Register);E(this,"requestOtp");E(this,"register");E(this,"guestLogIn");this.requestOtp=e.requestOtp,this.register=e.register,this.guestLogIn=e.guestLogIn}}const Ee="log-in-dialog",Ql=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(""),r=v(),i=v(""),m=v(),n=v(!1),d=()=>ce([r.value,...n.value?[m.value]:[]]),o=()=>{n.value=!1,i.value="",m.value=void 0},u=async()=>{const k=a.value.trim(),_=await e.ctrl.requestOtp(k);if(!_.successful){g.handleErrorStack(_.errorStack,s.failedToRequestOtp());return}n.value=!0,K.add(Z.createSuccess(s.otpHasBeenSentTo(k)))},f=Oe.create({iconSrc:"/icon/refresh-light-black.svg",darkIconSrc:"/icon/refresh-silver.svg",onClick:u}),S=async()=>{const k=await e.ctrl.logIn(a.value.trim(),i.value.trim());if(!k.successful){g.handleErrorStack(k.errorStack,k.errorStack.hasHttpError({targetErrRespCode:je.ErrRespCodeInvalidOtp})?s.invalidOtp():s.failedToLogIn());return}V.pop()},y=()=>{V.pop(),V.push(new Hl({requestOtp:Ae.requestOtp,register:ae.register}))};return(k,_)=>(c(),h(G,{title:t(s).logIn(),"close-by-btn":!0,onClose:_[4]||(_[4]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"contents__form"},{default:b(()=>[p(F,{id:Ee+"__email",label:t(s).email(),"err-msg":"",modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=x=>a.value=x),spec:t(We),onValidated:_[1]||(_[1]=x=>r.value=x),onInput:o},null,8,["id","label","modelValue","spec"]),n.value?(c(),h(F,{key:0,id:Ee+"__otp",label:t(s).otp(),"tail-btn":t(f),modelValue:i.value,"onUpdate:modelValue":_[2]||(_[2]=x=>i.value=x),spec:t(J),onValidated:_[3]||(_[3]=x=>m.value=x)},null,8,["id","label","tail-btn","modelValue","spec"])):C("",!0),p(Q,null,{default:b(()=>[n.value?C("",!0):(c(),h(P,{key:0,id:`${Ee}__send-otp`,size:t(ee).createL(),disabled:!d(),onClick:u},{default:b(()=>[U($(t(s).requestOtp()),1)]),_:1},8,["id","size","disabled"])),n.value?(c(),h(P,{key:1,id:`${Ee}__log-in`,size:t(ee).createL(),disabled:!d(),onClick:S},{default:b(()=>[U($(t(s).logIn()),1)]),_:1},8,["id","size","disabled"])):C("",!0)]),_:1})]),_:1}),p(pt,{margins:[30,0,30,0]}),p(Q,null,{default:b(()=>[p(P,{id:`${Ee}__log-in`,size:t(ee).createM(),theme:t(te).Text,onClick:y},{default:b(()=>[U($(t(s).registerFromHere()),1)]),_:1},8,["id","size","theme"])]),_:1})]),_:1},8,["title"]))}}),Gl=B(Ql,[["__scopeId","data-v-d9755528"]]),ke="account-edit-dialog",Yl=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(),r=v(),i=v(e.ctrl.account.nameEn),m=v(),n=v(e.ctrl.account.nameJa),d=v(),o=v(e.ctrl.account.email||""),u=v(),f=v(""),S=v(),y=v(""),k=v(),_=v(!1),x=Y=>{a.value=Y},O=()=>o.value!==e.ctrl.account.email,q=()=>a.value!==void 0||i.value!==e.ctrl.account.nameEn||n.value!==e.ctrl.account.nameJa||o.value!==(e.ctrl.account.email??"")||(O()?f.value!=="":!1)||(O()?y.value!=="":!1),w=()=>!he([r.value,m.value,d.value,u.value])&&(O()?ce([S.value,k.value]):!0),N=()=>{_.value=!1,f.value="",S.value=void 0,y.value="",k.value=void 0},M=async Y=>{for(const z of Y){const j=z.trim(),ye=await e.ctrl.requestOtp(j);if(!ye.successful){g.handleErrorStack(ye.errorStack,s.failedToRequestOtp());return}K.add(Z.createSuccess(s.otpHasBeenSentTo(j)))}_.value=!0},W=async()=>{me(a.value?{src:a.value,url:""}:void 0).then(Y=>{if(!Y.successful){g.handleErrorStack(Y.errorStack,Y.errorStack.hasHttpError({targetErrRespCode:je.ErrRespCodeInvalidOtp})?s.invalidOtp():s.failedToUpdate());return}K.add(Z.createSuccess(s.updated())),V.pop()})},me=async Y=>e.ctrl.updateAccount({...Y?{img:Y}:{},...e.ctrl.account.nameEn!==i.value?{nameEn:i.value}:{},...e.ctrl.account.nameJa!==n.value?{nameJa:n.value}:{},...O()?{email:o.value.trim(),otpToCurEmail:f.value.trim(),otpToNewEmail:y.value.trim()}:{}});return(Y,z)=>(c(),h(G,{title:t(s).editAccountInfo(),"close-by-btn":!0,onClose:z[12]||(z[12]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(Xe,{id:ke+"-profile-img",label:t(s).profileImg(),src:l.ctrl.account.imgUrl,alt:t(s).profileImg(),onInput:x,spec:t(Be),onValidated:z[0]||(z[0]=j=>r.value=j)},null,8,["id","label","src","alt","spec"]),(c(!0),T(H,null,le(e.ctrl.account.labeledNames,(j,ye)=>(c(),T(H,{key:ye},[j.langCode===t(A).EN?(c(),h(F,{key:0,id:`${ke}-name-${j.langCode}`,label:ye===0?t(s).username():t(s).username(j.langCode),modelValue:i.value,"onUpdate:modelValue":z[1]||(z[1]=pe=>i.value=pe),spec:t(J),onValidated:z[2]||(z[2]=pe=>m.value=pe)},null,8,["id","label","modelValue","spec"])):j.langCode===t(A).JA?(c(),h(F,{key:1,id:`${ke}-name-${j.langCode}`,label:ye===0?t(s).username():t(s).username(j.langCode),modelValue:n.value,"onUpdate:modelValue":z[3]||(z[3]=pe=>n.value=pe),spec:t(J),onValidated:z[4]||(z[4]=pe=>d.value=pe)},null,8,["id","label","modelValue","spec"])):C("",!0)],64))),128)),p(F,{id:ke+"-email",label:t(s).email(),modelValue:o.value,"onUpdate:modelValue":z[5]||(z[5]=j=>o.value=j),spec:t(We),onValidated:z[6]||(z[6]=j=>u.value=j),onInput:N},null,8,["id","label","modelValue","spec"]),O()&&_.value?(c(),h(F,{key:0,id:ke+"-otp-to-cur-email",label:t(s).otpSentTo(l.ctrl.account.email||""),"tail-btn":t(Oe).create({iconSrc:"/icon/refresh-light-black.svg",darkIconSrc:"/icon/refresh-silver.svg",onClick:()=>M([l.ctrl.account.email])}),modelValue:f.value,"onUpdate:modelValue":z[7]||(z[7]=j=>f.value=j),spec:t(J),onValidated:z[8]||(z[8]=j=>S.value=j)},null,8,["id","label","tail-btn","modelValue","spec"])):C("",!0),O()&&_.value?(c(),h(F,{key:1,id:ke+"-otp-to-new-email",label:t(s).otpSentTo(o.value),"tail-btn":t(Oe).create({iconSrc:"/icon/refresh-light-black.svg",darkIconSrc:"/icon/refresh-silver.svg",onClick:()=>M([o.value])}),modelValue:y.value,"onUpdate:modelValue":z[9]||(z[9]=j=>y.value=j),spec:t(J),onValidated:z[10]||(z[10]=j=>k.value=j)},null,8,["id","label","tail-btn","modelValue","spec"])):C("",!0),p(Q,null,{default:b(()=>{var j;return[O()&&!_.value?(c(),h(P,{key:0,fat:!0,disabled:!((j=u.value)!=null&&j.isSatisfied),onClick:z[11]||(z[11]=()=>M([l.ctrl.account.email,o.value]))},{default:b(()=>[U($(t(s).requestOtp()),1)]),_:1},8,["disabled"])):(c(),h(P,{key:1,fat:!0,disabled:!q()||!w(),onClick:W},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"]))]}),_:1})]),_:1})]),_:1},8,["title"]))}}),Xl=B(Yl,[["__scopeId","data-v-f15e4beb"]]),lt="account-transform-dialog",Kl=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(""),r=v(),i=v(""),m=v(),n=v(""),d=v(),o=v(!1),u=()=>ce([r.value,m.value,...o.value?[d.value]:[]]),f=()=>{o.value=!1,n.value="",d.value=void 0},S=async()=>{const _=i.value.trim(),x=await e.ctrl.requestOtp(_);if(!x.successful){g.handleErrorStack(x.errorStack,s.failedToRequestOtp());return}o.value=!0,K.add(Z.createSuccess(s.otpHasBeenSentTo(_)))},y=Oe.create({iconSrc:"/icon/refresh-light-black.svg",darkIconSrc:"/icon/refresh-silver.svg",onClick:S}),k=async()=>{const _=await e.ctrl.transformUser({email:i.value.trim(),nameEn:a.value,nameJa:a.value,otp:n.value.trim()});if(!_.successful){g.handleErrorStack(_.errorStack,_.errorStack.hasHttpError({targetErrRespCode:je.ErrRespCodeInvalidOtp})?s.invalidOtp():s.failedToUpdate());return}K.add(Z.createSuccess(s.userRegistrationDone())),V.pop()};return(_,x)=>(c(),h(G,{title:t(s).userRegistration(),"close-by-btn":!0,onClose:x[7]||(x[7]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(F,{id:`${lt}-name`,label:t(s).username(),modelValue:a.value,"onUpdate:modelValue":x[0]||(x[0]=O=>a.value=O),spec:t(J),onValidated:x[1]||(x[1]=O=>r.value=O)},null,8,["id","label","modelValue","spec"]),p(F,{id:lt+"-email",label:t(s).email(),modelValue:i.value,"onUpdate:modelValue":x[2]||(x[2]=O=>i.value=O),spec:t(We),onValidated:x[3]||(x[3]=O=>m.value=O),onInput:f},null,8,["id","label","modelValue","spec"]),o.value?(c(),h(F,{key:0,id:lt+"-otp",label:t(s).otp(),"tail-btn":t(y),modelValue:n.value,"onUpdate:modelValue":x[4]||(x[4]=O=>n.value=O),spec:t(J),onValidated:x[5]||(x[5]=O=>d.value=O)},null,8,["id","label","tail-btn","modelValue","spec"])):C("",!0),p(Q,null,{default:b(()=>[o.value?(c(),h(P,{key:1,fat:!0,disabled:!u(),onClick:k},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])):(c(),h(P,{key:0,fat:!0,disabled:!u(),onClick:x[6]||(x[6]=()=>S())},{default:b(()=>[U($(t(s).requestOtp()),1)]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["title"]))}}),Zl=B(Kl,[["__scopeId","data-v-33b319ff"]]);class en{static prependPngBase64Header(e){return`data:image/png;base64,${e}`}static async resizeSquare(e,a){return new Promise(r=>{const i=new FileReader;i.onload=function(m){const n=new Image;n.onload=()=>{const d=document.createElement("canvas");d.width=a,d.height=a;const o=d.getContext("2d");if(!o)return r(ne.createFailed(new Blob,ge.createFromMsg("ImageUtil: resize: Failed to get 2d context")));o.drawImage(n,0,0,a,a),d.toBlob(u=>u==null?r(ne.createFailed(new Blob,ge.createFromMsg("ImageUtil: resize: Failed to convert canvas to blob"))):r(ne.createSuccessful(u)),"image/png")},n.onerror=d=>r(ne.createFailed(new Blob,ge.createFromMsg(`ImageUtil: resize: Failed to load the image: ${d}`))),n.src=m.target.result},i.onerror=()=>r(ne.createFailed(new Blob,ge.createFromMsg("ImageUtil: resize: Failed to read the image"))),i.readAsDataURL(e)})}static async serialize(e){return new Promise(a=>{const r=new FileReader;r.onload=function(i){const m=r.result;return m==null?a(ne.createFailed("",ge.createFromMsg("ImageUtil: serialize: result is null"))):a(ne.createSuccessful(m.split(",")[1]))},r.onerror=()=>a(ne.createFailed("",ge.createFromMsg("ImageUtil: serialize: Failed to read the image"))),r.readAsDataURL(e)})}}const tn={class:"body"},an="crop-img-dialog",ln=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(null),r=v(""),i=v(),m=()=>!he([i.value]),n=()=>{if(a.value==null){g.handleError(new Error("cropperElem is null"),s.failedToCropImg());return}const d=a.value.getResult();if(!d.canvas){g.handleError(new Error("cropper result canvas is null"),s.failedToCropImg());return}d.canvas.toBlob(o=>{if(o==null){g.handleError(new Error("cropper result cropped is null"),s.failedToCropImg());return}Ne.debug(`cropped img size: ${o.size}`),en.resizeSquare(o,va).then(u=>{if(!u.successful){g.handleErrorStack(u.errorStack,s.failedToResizeImg());return}Ne.debug(`resized img size: ${u.value.size}`),e.ctrl.publishCropEvent({url:URL.createObjectURL(u.value),src:u.value,cap:r.value}),V.pop()})},"image/png")};return(d,o)=>(c(),h(G,{title:t(s).editImg(),"close-by-btn":!0,"no-padding":!0,onClose:o[2]||(o[2]=()=>t(V).pop())},{default:b(()=>[I("div",tn,[p(t(Va),{ref_key:"cropperElem",ref:a,class:"cropper",src:l.ctrl.srcUrl,"stencil-props":{aspectRatio:1},"resize-image":{adjustStencil:!1},"image-restriction":"stencil"},null,8,["src"]),l.ctrl.enableCaption?(c(),h(F,{key:0,class:"body__caption",id:`${an}-caption-input`,label:t(s).caption(),modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=u=>r.value=u),spec:t(Xt),onValidated:o[1]||(o[1]=u=>i.value=u)},null,8,["id","label","modelValue","spec"])):C("",!0),p(P,{onClick:n,fat:!0,disabled:!m()},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])])]),_:1},8,["title"]))}}),nn=B(ln,[["__scopeId","data-v-47c71d2f"]]),sn={class:"body"},rn=["src","alt"],on={key:0},dn=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){return(e,a)=>(c(),h(G,{title:t(s).imgPreview(),"no-padding":!0,onClose:a[0]||(a[0]=()=>t(V).pop())},{default:b(()=>[I("div",sn,[I("img",{class:"body__img",src:l.ctrl.url,alt:l.ctrl.alt},null,8,rn),l.ctrl.caption?(c(),T("p",on,$(l.ctrl.caption),1)):C("",!0),l.ctrl.onDelete?(c(),h(P,{key:1,onClick:l.ctrl.onDelete,theme:t(te).Danger,fat:!0},{default:b(()=>[U($(t(s).delete()),1)]),_:1},8,["onClick","theme"])):C("",!0)])]),_:1},8,["title"]))}}),cn=B(dn,[["__scopeId","data-v-c30950d6"]]);class un{constructor(e){E(this,"name",L.PreviewImg);E(this,"url");E(this,"alt");E(this,"caption");E(this,"onDelete");this.url=e.url,this.alt=e.alt,this.caption=e.caption,this.onDelete=e.onDelete}}class nt{constructor(e,a){this.id=e,this.label=a}}class mn{constructor(e,a=0){E(this,"stepChangeEventSubscribers",[]);E(this,"currentStepIdx");this.steps=e,this.initialStepIdx=a,this.currentStepIdx=a}get first(){return this.steps[0]}get last(){return this.steps[this.steps.length-1]}subscribeToStepChangeEvent(e){this.stepChangeEventSubscribers.push(e)}unsubscribeFromStepChangeEvent(e){this.stepChangeEventSubscribers=this.stepChangeEventSubscribers.filter(a=>a!==e)}next(){this.currentStepIdx++,this.stepChangeEventSubscribers.forEach(e=>e(this.currentStepIdx,this.steps[this.currentStepIdx]))}back(){this.currentStepIdx--,this.stepChangeEventSubscribers.forEach(e=>e(this.currentStepIdx,this.steps[this.currentStepIdx]))}}const Jt=l=>(Qe("data-v-0f8e5ca1"),l=l(),Ge(),l),pn={key:0,class:"steps"},vn=["data-first","data-last"],gn=["data-finished","data-current"],fn=["data-current"],bn=["data-finished","data-current","data-first","data-last"],_n=Jt(()=>I("div",{class:"steps__step__bar__left"},null,-1)),hn=Jt(()=>I("div",{class:"steps__step__bar__right"},null,-1)),yn=[_n,hn],kn=["data-finished","data-current"],wn=R({__name:"index",props:{collection:{type:Object,required:!0}},setup(l){const e=l,a=v(e.collection.initialStepIdx),r=(i,m)=>{a.value=i};return X(()=>{e.collection.subscribeToStepChangeEvent(r)}),ie(()=>{e.collection.unsubscribeFromStepChangeEvent(r)}),(i,m)=>l.collection.steps.length>1?(c(),T("div",pn,[(c(!0),T(H,null,le(l.collection.steps,(n,d)=>(c(),T("div",{class:"steps__step",key:d,"data-first":d===0,"data-last":d===l.collection.steps.length-1},[I("div",{class:"steps__step__mark","data-finished":d<a.value,"data-current":d===a.value},[I("div",{class:"steps__step__mark__wave","data-current":d===a.value},null,8,fn)],8,gn),I("div",{class:"steps__step__bar","data-finished":d<a.value,"data-current":d===a.value,"data-first":d===0,"data-last":d===l.collection.steps.length-1},yn,8,bn),I("div",{class:"steps__step__label","data-finished":d<a.value,"data-current":d===a.value},$(n.label),9,kn)],8,vn))),128))])):C("",!0)}}),Cn=B(wn,[["__scopeId","data-v-0f8e5ca1"]]),Sn="/icon/arrow-down-light-black.svg",En="/icon/arrow-down-silver.svg",Wt=l=>(Qe("data-v-340ea27d"),l=l(),Ge(),l),In={class:"select-input"},Vn=["for"],$n={class:"select-input__input"},Tn=["id","value","data-valid","data-invalid"],xn=["value"],Dn=Wt(()=>I("img",{class:"select-input__input__arrow-down block-light",src:Sn},null,-1)),On=Wt(()=>I("img",{class:"select-input__input__arrow-down block-dark",src:En},null,-1)),Nn=R({__name:"index",props:{id:{type:String,required:!0},label:{type:String,required:!1,default:""},modelValue:{type:String,required:!0},options:{type:Array,required:!0},spec:{type:Object,required:!1},disabled:{type:Boolean,required:!1,default:!1},errMsg:{type:String,required:!1,default:""},tailBtn:{type:Object,required:!1}},emits:["update:modelValue","validated","input"],setup(l,{emit:e}){const a=l,r=v(),i=e,m=d=>{const o=d.target.value;i("update:modelValue",o),i("input",o),n(o)},n=d=>{a.spec&&(r.value=a.spec.isSatisfiedBy(d),i("validated",r.value))};return X(()=>{a.modelValue&&n(a.modelValue)}),(d,o)=>(c(),T("div",In,[I("label",{class:"select-input__label",for:l.id},$(l.label),9,Vn),I("div",$n,[I("select",{id:l.id,class:"select-input__input__input",value:l.modelValue,"data-valid":r.value&&r.value.isSatisfied,"data-invalid":r.value&&!r.value.isSatisfied,onInput:m},[(c(!0),T(H,null,le(l.options,u=>(c(),T("option",{value:u.value},$(u.label),9,xn))),256))],40,Tn),Dn,On,l.tailBtn?(c(),h(Kt,{key:0,class:"select-input__input__tail-btn",btn:l.tailBtn},null,8,["btn"])):C("",!0)]),r.value&&r.value.errorMsg?(c(),h(Je,{key:0,msg:r.value.errorMsg},null,8,["msg"])):C("",!0)]))}}),vt=B(Nn,[["__scopeId","data-v-340ea27d"]]),De=class De{};E(De,"list",async()=>{const e=await Bt.get(De.path);if(!e.successful||!e.value.ok)return Fe.createFailed([],e.value,e.errorStack);const a=await e.value.json();return Fe.createSuccessful(a.items.map(r=>$a.create(r)),e.value)}),E(De,"path","/countries");let ut=De;const ue=class ue{};E(ue,"list",async()=>{if(!ue.items){const e=await ut.list();if(!e.successful)return e;ue.items=e.value}return ne.createSuccessful(ue.items)}),E(ue,"get",async e=>{const a=await ue.list();if(!a.successful)return ne.createFailed(kt,a.errorStack);const r=a.value.find(i=>i.id===e);return r?ne.createSuccessful(r):ne.createFailed(kt,ge.createFromMsg(`CountryRepository.get: country not found by id(${e})`))}),E(ue,"items");let mt=ue;const qn=l=>(Qe("data-v-5de5ed8b"),l=l(),Ge(),l),Bn=qn(()=>I("div",{id:"card-element"},null,-1)),An=R({__name:"index",props:{cardElem:{type:Object,required:!0}},setup(l){const e=l,a=v(""),r=async()=>{e.cardElem.mount("#card-element")};return X(()=>{r(),e.cardElem.on("change",i=>{a.value=i.error?i.error.message:""})}),(i,m)=>(c(),T(H,null,[Bn,a.value?(c(),h(Je,{key:0,msg:a.value},null,8,["msg"])):C("",!0)],64))}}),gt=B(An,[["__scopeId","data-v-5de5ed8b"]]);class _e{}E(_e,"createCardElemStyle",e=>(console.log("isDarkMode",e),{base:{iconColor:e?ga:ot,color:e?fa:ba,fontSize:_a,"::placeholder":{color:ot}},invalid:{iconColor:e?_t:ht,color:e?_t:ht}}));const Un={class:"body"},Rn={class:"body__form"},oe="org-create-dialog",Pn=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(),r=v(),i=v(!1),m=new nt("org_info",s.enterBusinessInfo()),n=new nt("billing_address",s.enterBillingAddress()),d=new nt("cc_info",s.enterCCInfo()),o=new mn([m,n,d]),u=v(m),f=()=>{switch(u.value.id){case m.id:return ce([e.ctrl.fidValidated,e.ctrl.orgNameValidated,e.ctrl.telValidated,e.ctrl.picValidated]);case n.id:return ce([e.ctrl.billingNameValidated,e.ctrl.billingCountryIdValidated,e.ctrl.billingAddressValidated]);case d.id:return i.value;default:return g.handleErrorQuietly(new Error("Unknown step id: "+u.value.id)),!1}},S=q=>{var w,N;switch(q.id){case m.id:(w=document.getElementById(oe+"-name__input"))==null||w.focus();break;case n.id:(N=document.getElementById(oe+"-billing-name__input"))==null||N.focus();break;case d.id:break;default:g.handleErrorQuietly(new Error(`${oe}: onStepChange: Unknown step id(${q.id})`))}},y=(q,w)=>{u.value=w,setTimeout(()=>{S(w)})},k=v([]),_=async()=>{if(!a.value){g.handleError(new Error("strp is not set"));return}if(!r.value){g.handleError(new Error("cardElem is not set"));return}console.log(r.value);const q=await e.ctrl.createOrg({fid:e.ctrl.fid,name:e.ctrl.orgName,tel:e.ctrl.tel,pic:e.ctrl.pic,billingName:e.ctrl.billingName,billingCountryId:Number(e.ctrl.billingCountryId),billingAddress:e.ctrl.billingAddress});if(!q.successful){g.handleErrorStack(q.errorStack,s.failedToCreateOrg());return}e.ctrl.switchWs(q.value,async()=>{var Y,z;const w=await e.ctrl.createPaymentSetupIntent();if(!w.successful){g.handleErrorStack(w.errorStack);return}const{paymentMethod:N,error:M}=await a.value.createPaymentMethod("card",r.value);if(M){g.handleError(M);return}const W=await a.value.confirmCardSetup(w.value.clientSecret,{payment_method:N.id});if(W.error){g.handleError(W.error);return}(Y=N.card)!=null&&Y.last4;const me=await e.ctrl.createPaymentMethod({id:N.id,ccLast4:((z=N.card)==null?void 0:z.last4)||"****"});if(!me.successful){g.handleErrorStack(me.errorStack,s.failedToRegisterCc());return}K.add(Z.createSuccess(s.orgCreated())),V.pop()})},x=async()=>{a.value=Stripe(void 0),r.value=a.value.elements({}).create("card",{hidePostalCode:!0,style:_e.createCardElemStyle(se.isDarkMode)}),r.value.on("change",q=>{i.value=q.complete}),setTimeout(()=>{S(u.value)})},O=q=>{r.value&&r.value.update({style:_e.createCardElemStyle(q)})};return X(()=>{se.subscribeToDarkModeChangeEvent(O),o.subscribeToStepChangeEvent(y),mt.list().then(q=>{if(!q.successful){g.handleErrorStack(q.errorStack);return}k.value=q.value.map(w=>({label:w.label,value:String(w.id)}))}),x()}),ie(()=>{se.unsubscribeFromDarkModeChangeEvent(O),o.unsubscribeFromStepChangeEvent(y)}),(q,w)=>(c(),h(G,{title:t(s).registerBusiness(),"close-by-btn":!0,onClose:w[16]||(w[16]=()=>t(V).pop())},{default:b(()=>[I("div",Un,[p(Cn,{class:"body__steps",collection:t(o)},null,8,["collection"]),I("div",Rn,[u.value.id===t(m).id?(c(),T(H,{key:0},[p(F,{class:"body__form__input",id:oe+"-name",label:t(s).businessName(),modelValue:l.ctrl.orgName,"onUpdate:modelValue":w[0]||(w[0]=N=>l.ctrl.orgName=N),spec:t(J),onValidated:w[1]||(w[1]=N=>l.ctrl.orgNameValidated=N),"help-msg":"TODO: implement: you can localize the name later!!!"},null,8,["id","label","modelValue","spec"]),p(F,{class:"body__form__input",id:oe+"-tel",label:t(s).tel(),modelValue:l.ctrl.tel,"onUpdate:modelValue":w[2]||(w[2]=N=>l.ctrl.tel=N),spec:t(J),onValidated:w[3]||(w[3]=N=>l.ctrl.telValidated=N)},null,8,["id","label","modelValue","spec"]),p(F,{class:"body__form__input",id:oe+"-pic",label:t(s).pic(),modelValue:l.ctrl.pic,"onUpdate:modelValue":w[4]||(w[4]=N=>l.ctrl.pic=N),spec:t(J),onValidated:w[5]||(w[5]=N=>l.ctrl.picValidated=N)},null,8,["id","label","modelValue","spec"]),p(F,{class:"body__form__input",id:oe+"-fid",label:t(s).wsId(),modelValue:l.ctrl.fid,"onUpdate:modelValue":w[6]||(w[6]=N=>l.ctrl.fid=N),spec:t(He),onValidated:w[7]||(w[7]=N=>l.ctrl.fidValidated=N),"help-msg":"TODO: implement"},null,8,["id","label","modelValue","spec"])],64)):u.value.id===t(n).id?(c(),T(H,{key:1},[p(F,{class:"body__form__input",id:oe+"-billing-name",label:t(s).billingName(),modelValue:l.ctrl.billingName,"onUpdate:modelValue":w[8]||(w[8]=N=>l.ctrl.billingName=N),spec:t(J),onValidated:w[9]||(w[9]=N=>l.ctrl.billingNameValidated=N)},null,8,["id","label","modelValue","spec"]),p(vt,{class:"body__form__input",id:oe+"-country",label:t(s).countryOrRegion(),modelValue:l.ctrl.billingCountryId,"onUpdate:modelValue":w[10]||(w[10]=N=>l.ctrl.billingCountryId=N),spec:t(Nt),options:k.value,onValidated:w[11]||(w[11]=N=>l.ctrl.billingCountryIdValidated=N)},null,8,["id","label","modelValue","spec","options"]),p(F,{class:"body__form__input",id:oe+"-billing-address",label:t(s).billingAddress(),modelValue:l.ctrl.billingAddress,"onUpdate:modelValue":w[12]||(w[12]=N=>l.ctrl.billingAddress=N),spec:t(J),onValidated:w[13]||(w[13]=N=>l.ctrl.billingAddressValidated=N)},null,8,["id","label","modelValue","spec"])],64)):u.value.id===t(d).id?(c(),T(H,{key:2},[r.value?(c(),h(gt,{key:0,"card-elem":r.value},null,8,["card-elem"])):C("",!0)],64)):C("",!0),p(Q,{class:"body__form__action"},{default:b(()=>[u.value.id!==t(o).first.id?(c(),h(P,{key:0,theme:t(te).Outlined,fat:!0,onClick:w[14]||(w[14]=()=>t(o).back())},{default:b(()=>[U($(t(s).back()),1)]),_:1},8,["theme"])):C("",!0),u.value.id!==t(o).last.id?(c(),h(P,{key:1,fat:!0,disabled:!f(),onClick:w[15]||(w[15]=()=>t(o).next())},{default:b(()=>[U($(t(s).next()),1)]),_:1},8,["disabled"])):C("",!0),u.value.id===t(o).last.id?(c(),h(P,{key:2,fat:!0,disabled:!f(),onClick:_},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])):C("",!0)]),_:1})])])]),_:1},8,["title"]))}}),Mn=B(Pn,[["__scopeId","data-v-d35723bf"]]),we="org-edit-dialog",Fn=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(),r=v(),i=v(e.ctrl.workspace.fid),m=v(),n=v(e.ctrl.org.nameEn),d=v(),o=v(e.ctrl.org.nameJa),u=v(),f=v(e.ctrl.org.tel),S=v(),y=v(e.ctrl.org.pic),k=v(),_=N=>{a.value=N},x=()=>a.value!==void 0||i.value!==e.ctrl.workspace.fid||n.value!==e.ctrl.org.nameEn||o.value!==e.ctrl.org.nameJa||f.value!==e.ctrl.org.tel||y.value!==e.ctrl.org.pic,O=()=>!he([r.value,m.value,d.value,u.value,S.value,k.value]),q=async()=>{!x()||!O()||w(a.value?{src:a.value,url:""}:void 0).then(N=>{if(!N.successful){g.handleErrorStack(N.errorStack,s.failedToUpdate());return}K.add(Z.createSuccess(s.updated())),V.pop()})},w=async N=>{if(e.ctrl.workspace.fid!==i.value){const W=await e.ctrl.updateWs({id:e.ctrl.workspace.id,fid:i.value});if(!W.successful)return W}const M={};return N&&(M.img=N),e.ctrl.org.nameEn!==n.value&&(M.nameEn=n.value),e.ctrl.org.nameJa!==o.value&&(M.nameJa=o.value),e.ctrl.org.tel!==f.value&&(M.tel=f.value),e.ctrl.org.pic!==y.value&&(M.pic=y.value),Object.keys(M).length===0?ne.createSuccessful({}):e.ctrl.updateOrg(e.ctrl.org.id,M)};return(N,M)=>(c(),h(G,{title:t(s).editBasicInfo(),"close-by-btn":!0,onClose:M[11]||(M[11]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(Xe,{id:we+"-logo-img",label:t(s).businessLogo(),src:l.ctrl.org.imgUrl,alt:t(s).businessLogo(),onInput:_,spec:t(Be),onValidated:M[0]||(M[0]=W=>r.value=W)},null,8,["id","label","src","alt","spec"]),p(F,{id:`${we}-fid`,label:t(s).wsId(),modelValue:i.value,"onUpdate:modelValue":M[1]||(M[1]=W=>i.value=W),spec:t(He),onValidated:M[2]||(M[2]=W=>m.value=W)},null,8,["id","label","modelValue","spec"]),(c(!0),T(H,null,le(e.ctrl.org.labeledNames,(W,me)=>(c(),T(H,{key:me},[W.langCode===t(A).EN?(c(),h(F,{key:0,id:`${we}-name-${W.langCode}`,label:me===0?t(s).businessName():t(s).businessName(W.langCode),modelValue:n.value,"onUpdate:modelValue":M[3]||(M[3]=Y=>n.value=Y),spec:t(J),onValidated:M[4]||(M[4]=Y=>d.value=Y)},null,8,["id","label","modelValue","spec"])):W.langCode===t(A).JA?(c(),h(F,{key:1,id:`${we}-name-${W.langCode}`,label:me===0?t(s).businessName():t(s).businessName(W.langCode),modelValue:o.value,"onUpdate:modelValue":M[5]||(M[5]=Y=>o.value=Y),spec:t(J),onValidated:M[6]||(M[6]=Y=>u.value=Y)},null,8,["id","label","modelValue","spec"])):C("",!0)],64))),128)),p(F,{id:`${we}-tel`,label:t(s).tel(),modelValue:f.value,"onUpdate:modelValue":M[7]||(M[7]=W=>f.value=W),spec:t(J),onValidated:M[8]||(M[8]=W=>S.value=W)},null,8,["id","label","modelValue","spec"]),p(F,{id:`${we}-pic`,label:t(s).pic(),modelValue:y.value,"onUpdate:modelValue":M[9]||(M[9]=W=>y.value=W),spec:t(J),onValidated:M[10]||(M[10]=W=>k.value=W)},null,8,["id","label","modelValue","spec"]),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!x()||!O(),onClick:q},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),Ln=B(Fn,[["__scopeId","data-v-a7ec41bc"]]),zn=B(Ta,[["__scopeId","data-v-b7fc2c22"]]),Et="org-new-member-dialog",Jn=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(""),r=v(),i=v(!1),m=()=>{var d;return!!((d=r.value)!=null&&d.isSatisfied)},n=()=>{e.ctrl.invite({oid:e.ctrl.org.id,invitations:[{email:a.value,isAdmin:i.value}]}).then(d=>{if(!d.successful){g.handleErrorStack(d.errorStack,s.failedToSendInvitations());return}K.add(Z.createSuccess(s.invitationSent())),V.pop()})};return(d,o)=>(c(),h(G,{title:t(s).newMember(),"close-by-btn":!0,onClose:o[3]||(o[3]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(F,{id:Et+"-email",label:t(s).email(),modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=u=>a.value=u),spec:t(Zt),onValidated:o[1]||(o[1]=u=>r.value=u)},null,8,["id","label","modelValue","spec"]),p(zn,{id:Et+"-is-admin",label:t(s).adminRole(),size:t(ee).createS(),"true-option":{label:t(s).have(),value:!0},"false-option":{label:t(s).notHave(),value:!1},modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=u=>i.value=u)},null,8,["id","label","size","true-option","false-option","modelValue"]),p(Q,null,{default:b(()=>[p(P,{onClick:n,fat:!0,disabled:!m()},{default:b(()=>[U($(t(s).invite()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),Wn=B(Jn,[["__scopeId","data-v-bbd366d3"]]),jn={class:"body"},Hn={class:"flex-wrap gap-xxs"},Qn={class:"b"},Gn={class:"b dim-grey"},Yn=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=()=>{e.ctrl.deleteMember({oid:e.ctrl.org.id,targetUid:e.ctrl.member.id}).then(r=>{if(!r.successful){g.handleErrorStack(r.errorStack,s.failedToDelete());return}K.add(Z.createSuccess(s.deleted())),V.pop()})};return(r,i)=>(c(),h(G,{type:t(Ye).Warning,title:t(s).deleteMember(),"close-by-btn":!0,onClose:i[0]||(i[0]=()=>t(V).pop())},{default:b(()=>[I("div",jn,[I("p",null,$(t(s).doYouReallyDeleteTheFollowingUser()),1),I("p",Hn,[I("span",Qn,$(l.ctrl.member.name),1),I("span",Gn,"<"+$(l.ctrl.member.email)+">",1)]),p(Q,{class:"body__btn-group"},{default:b(()=>[p(P,{onClick:a,fat:!0,theme:t(te).Danger},{default:b(()=>[U($(t(s).delete()),1)]),_:1},8,["theme"])]),_:1})])]),_:1},8,["type","title"]))}}),Xn=B(Yn,[["__scopeId","data-v-e66ddf0b"]]),Kn={class:"body"},Zn={class:"body__form"},st="product-create-dialog",es=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=()=>ce([e.ctrl.productNameValidated,e.ctrl.fidValidated,e.ctrl.imgValidated]),r=m=>{e.ctrl.img=m},i=async()=>{if(!e.ctrl.img){g.handleError(new Error("img is not set"));return}e.ctrl.createProduct({fid:e.ctrl.fid,nameEn:e.ctrl.productName,nameJa:e.ctrl.productName,img:{src:e.ctrl.img,url:""}}).then(m=>{if(!m.successful){g.handleErrorStack(m.errorStack,s.failedToCreate());return}K.add(Z.createSuccess(s.created())),V.pop()})};return(m,n)=>(c(),h(G,{title:t(s).registerProduct(),"close-by-btn":!0,onClose:n[5]||(n[5]=()=>t(V).pop())},{default:b(()=>[I("div",Kn,[I("div",Zn,[p(Xe,{class:"body__form__input",id:st+"-profile-img",label:t(s).productImage(),src:"/img/grey.svg",alt:t(s).productImage(),onInput:r,spec:t(Be),onValidated:n[0]||(n[0]=d=>l.ctrl.imgValidated=d)},null,8,["id","label","alt","spec"]),p(F,{class:"body__form__input",id:st+"-product-name",label:t(s).productName(),modelValue:l.ctrl.productName,"onUpdate:modelValue":n[1]||(n[1]=d=>l.ctrl.productName=d),spec:t(J),onValidated:n[2]||(n[2]=d=>l.ctrl.productNameValidated=d)},null,8,["id","label","modelValue","spec"]),p(F,{class:"body__form__input",id:st+"-fid",label:t(s).productId(),modelValue:l.ctrl.fid,"onUpdate:modelValue":n[3]||(n[3]=d=>l.ctrl.fid=d),spec:t(He),onValidated:n[4]||(n[4]=d=>l.ctrl.fidValidated=d)},null,8,["id","label","modelValue","spec"]),p(Q,{class:"body__form__action"},{default:b(()=>[p(P,{fat:!0,disabled:!a(),onClick:i},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})])])]),_:1},8,["title"]))}}),ts=B(es,[["__scopeId","data-v-6ffb975c"]]),Ue="product-create-dialog",as=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=d=>{e.ctrl.newImg=d},r=()=>e.ctrl.newImg!==void 0||e.ctrl.newFid!==e.ctrl.product.fid||e.ctrl.newProductNameEn!==e.ctrl.product.nameEn||e.ctrl.newProductNameJa!==e.ctrl.product.nameJa,i=()=>!he([e.ctrl.newImgValidated,e.ctrl.newFidValidated,e.ctrl.newProductNameEnValidated,e.ctrl.newProductNameJaValidated]),m=async()=>{!r()||!i()||n(e.ctrl.newImg?{src:e.ctrl.newImg,url:ha}:void 0).then(d=>{if(!d.successful){g.handleErrorStack(d.errorStack,s.failedToUpdate());return}K.add(Z.createSuccess(s.updated())),V.pop()})},n=async d=>e.ctrl.updateProduct({id:e.ctrl.product.id,...e.ctrl.product.fid!==e.ctrl.newFid?{fid:e.ctrl.newFid}:{},...e.ctrl.product.nameEn!==e.ctrl.newProductNameEn?{nameEn:e.ctrl.newProductNameEn}:{},...e.ctrl.product.nameJa!==e.ctrl.newProductNameJa?{nameJa:e.ctrl.newProductNameJa}:{},...d?{img:d}:{}});return(d,o)=>(c(),h(G,{title:t(s).editBasicInfo(),"close-by-btn":!0,onClose:o[7]||(o[7]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(Xe,{id:Ue+"-profile-img",label:t(s).logo(),src:l.ctrl.product.imgUrl,alt:t(s).logo(),onInput:a,spec:t(Be),onValidated:o[0]||(o[0]=u=>l.ctrl.newImgValidated=u)},null,8,["id","label","src","alt","spec"]),p(F,{id:Ue+"-fid",label:t(s).productId(),modelValue:l.ctrl.newFid,"onUpdate:modelValue":o[1]||(o[1]=u=>l.ctrl.newFid=u),spec:t(He),onValidated:o[2]||(o[2]=u=>l.ctrl.newFidValidated=u)},null,8,["id","label","modelValue","spec"]),(c(!0),T(H,null,le(e.ctrl.product.labeledNames,(u,f)=>(c(),T(H,{key:f},[u.langCode===t(A).EN?(c(),h(F,{key:0,id:`${Ue}-name-${u.langCode}`,label:f===0?t(s).productName():t(s).productName(u.langCode),modelValue:l.ctrl.newProductNameEn,"onUpdate:modelValue":o[3]||(o[3]=S=>l.ctrl.newProductNameEn=S),spec:t(J),onValidated:o[4]||(o[4]=S=>l.ctrl.newProductNameEnValidated=S)},null,8,["id","label","modelValue","spec"])):u.langCode===t(A).JA?(c(),h(F,{key:1,id:`${Ue}-name-${u.langCode}`,label:f===0?t(s).productName():t(s).productName(u.langCode),modelValue:l.ctrl.newProductNameJa,"onUpdate:modelValue":o[5]||(o[5]=S=>l.ctrl.newProductNameJa=S),spec:t(J),onValidated:o[6]||(o[6]=S=>l.ctrl.newProductNameJaValidated=S)},null,8,["id","label","modelValue","spec"])):C("",!0)],64))),128)),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!r()||!i(),onClick:m},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),ls=B(as,[["__scopeId","data-v-77e4ad96"]]);var jt=(l=>(l.Form="form",l.Discourse="discourse",l))(jt||{});const ns=l=>{const e=l.cloneNode(!0);e.style.height="1px",e.style.width=l.offsetWidth+"px",e.style.overflow="scroll",de.appendToTemp(e);const a=e.scrollHeight;return de.removeFromTemp(e),a},ss={class:"img-input-btn"},rs=["for"],is=["id"],os=R({__name:"btn",props:{id:{type:String,required:!0},src:{type:String,required:!0},alt:{type:String,required:!0,default:""},spec:{type:Object,required:!0},enableCaption:{type:Boolean,required:!1,default:!1}},emits:["input"],setup(l,{emit:e}){const a=l,r=v(),i=e,m=d=>{console.log("getCropResultIfAny"),i("input",d)},n=d=>{const o=d.target.files,u=o==null?void 0:o.item(0);if(!u){g.handleError(new Error("file is null"));return}r.value&&URL.revokeObjectURL(r.value),r.value=URL.createObjectURL(u);const f=new zt(r.value,a.enableCaption);f.subscribeToCropEvent(m),V.push(f),d.target.value=""};return(d,o)=>(c(),T("div",ss,[I("label",{class:"img-input-btn__label",for:l.id},null,8,rs),I("input",{id:l.id,class:"img-input-btn__input",type:"file",accept:"image/*",onChange:n},null,40,is)]))}}),ds=B(os,[["__scopeId","data-v-736a3bf4"]]),cs={class:"rich-input-form"},us=["id","value","data-empty","data-valid","data-invalid"],ms={key:0,class:"rich-input-form__console"},ps="rich-input-form",vs=36*3,gs=R({__name:"index",props:{ctrl:{type:Object,required:!0},value:{type:String,required:!0},imgs:{type:Array,required:!1,default:()=>[]},dataEmpty:{type:Boolean,required:!1,default:!1},dataValid:{type:Boolean,required:!1,default:!1},dataInvalid:{type:Boolean,required:!1,default:!1},allowImgs:{type:Boolean,required:!1,default:!0}},setup(l){const e=l,a=v(vs),r=v(e.imgs),i=v([]),m=o=>{const u=o.target.value;e.ctrl.publishTxtChangeEvent(u),a.value=ns(o.target)},n=()=>{i.value=r.value.map((o,u)=>({id:String(u),src:o.url,alt:o.cap||"",onClick:()=>{V.push(new un({url:o.url,alt:o.cap||"",caption:o.cap,onDelete:()=>{o.src&&URL.revokeObjectURL(o.url),r.value=r.value.filter((f,S)=>S!==u),e.ctrl.publishImgsChangeEvent(r.value),n(),V.pop()}}))}}))},d=o=>{r.value=[...r.value,o],e.ctrl.publishImgsChangeEvent(r.value),n()};return X(()=>{n()}),(o,u)=>(c(),T("div",cs,[I("textarea",{id:l.ctrl.inputId,class:"rich-input-form__textarea",style:be({height:a.value+"px"}),value:l.value,"data-empty":l.dataEmpty,"data-valid":l.dataValid,"data-invalid":l.dataInvalid,onInput:m},null,44,us),l.allowImgs?(c(),T("div",ms,[p(ds,{id:ps+"-img",src:"",alt:t(s).inputImage(),spec:t(Be),"enable-caption":!0,onInput:d},null,8,["id","alt","spec"]),i.value.length>0?(c(),h(Lt,{key:0,class:"rich-input-form__console__thumbnails",thumbnails:i.value},null,8,["thumbnails"])):C("",!0)])):C("",!0)]))}}),fs=B(gs,[["__scopeId","data-v-74cd819d"]]);class ft{constructor(e,a){E(this,"txtChangeEventSubscribers",[]);E(this,"imgsChangeEventSubscribers",[]);this.context=e,this.inputId=a}subscribeToTxtChangeEvent(e){this.txtChangeEventSubscribers.push(e)}unsubscribeFromTxtChangeEvent(e){this.txtChangeEventSubscribers=this.txtChangeEventSubscribers.filter(a=>a!==e)}publishTxtChangeEvent(e){this.txtChangeEventSubscribers.forEach(a=>a(e))}subscribeToImgsChangeEvent(e){this.imgsChangeEventSubscribers.push(e)}unsubscribeFromImgsChangeEvent(e){this.imgsChangeEventSubscribers=this.imgsChangeEventSubscribers.filter(a=>a!==e)}publishImgsChangeEvent(e){this.imgsChangeEventSubscribers.forEach(a=>a(e))}static create(e){return new ft(jt.Form,e)}}const bs=["data-gap-size"],_s=["for"],hs=R({__name:"index",props:{id:{type:String,required:!0},label:{type:String,required:!0},modelValue:{type:String,required:!0},imgs:{type:Array,required:!1,default:()=>[]},spec:{type:Object,required:!0},gapSize:{type:Object,required:!1,default:()=>ee.createXS()},allowImgs:{type:Boolean,required:!1,default:!0},disabled:{type:Boolean,required:!1,default:!1},errMsg:{type:String,required:!1,default:""}},emits:["update:modelValue","validated","inputImgs"],setup(l,{emit:e}){const a=l,r=e,i=v(),m=u=>{i.value=a.spec.isSatisfiedBy(u),r("validated",i.value)},n=u=>{r("update:modelValue",u),m(u)},d=u=>{r("inputImgs",u)},o=ft.create(a.id);return o.subscribeToTxtChangeEvent(n),o.subscribeToImgsChangeEvent(d),X(()=>{a.modelValue&&m(a.modelValue)}),(u,f)=>(c(),T("div",{class:"rich-input","data-gap-size":l.gapSize.val},[I("label",{class:"rich-input__label",for:l.id},$(l.label),9,_s),p(fs,{ctrl:t(o),value:l.modelValue,imgs:l.imgs,"data-empty":l.modelValue.trim().length===0,"data-valid":i.value&&i.value.isSatisfied,"data-invalid":i.value&&!i.value.isSatisfied,"allow-imgs":l.allowImgs},null,8,["ctrl","value","imgs","data-empty","data-valid","data-invalid","allow-imgs"]),i.value&&i.value.errorMsg?(c(),h(Je,{key:0,msg:i.value.errorMsg},null,8,["msg"])):C("",!0)],8,bs))}}),Ke=B(hs,[["__scopeId","data-v-81ce9b97"]]),It="create-psq-dialog",ys=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=()=>ce([e.ctrl.txtValidated]),r=()=>{if(!a()){g.handleError(Se.createUiError(`${It}: send: not satisfied`));return}e.ctrl.createPsq({pid:e.ctrl.product.id,txtEn:e.ctrl.txt,txtJa:e.ctrl.txt}).then(i=>{if(!i.successful){g.handleErrorStack(i.errorStack,s.failedToCreate());return}K.add(Z.createSuccess(s.created())),V.pop()})};return(i,m)=>(c(),h(G,{title:t(s).createQuestion(),"close-by-btn":!0,onClose:m[2]||(m[2]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(Ke,{id:It+"-txt",label:t(s).question(),modelValue:l.ctrl.txt,"onUpdate:modelValue":m[0]||(m[0]=n=>l.ctrl.txt=n),spec:t(J),onValidated:m[1]||(m[1]=n=>l.ctrl.txtValidated=n),"allow-imgs":!1},null,8,["id","label","modelValue","spec"]),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!a(),onClick:r},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),ks=B(ys,[["__scopeId","data-v-7808f468"]]),ws={class:"body"},Cs={class:"pre"},Ss={class:"body__question"},Es=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=()=>{e.ctrl.deletePsq(e.ctrl.psq).then(r=>{if(!r.successful){g.handleErrorStack(r.errorStack,s.failedToDelete());return}K.add(Z.createSuccess(s.deleted())),V.pop()})};return(r,i)=>(c(),h(G,{title:t(s).deleteQuestion(),onClose:i[0]||(i[0]=()=>t(V).pop())},{default:b(()=>[I("div",ws,[I("p",Cs,$(t(s).areYouSureYouWantDeletedTheFollowingQuestion()),1),I("p",Ss,$(l.ctrl.psq.txt),1),p(Q,{class:"body__btn-group"},{default:b(()=>[p(P,{fat:!0,onClick:a},{default:b(()=>[U($(t(s).delete()),1)]),_:1})]),_:1})])]),_:1},8,["title"]))}}),Is=B(Es,[["__scopeId","data-v-217962de"]]),Re="create-discussion-dialog",Vs=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v([]),r=()=>ce([e.ctrl.newDiscussionTypeValidated,e.ctrl.newDiscussionTitleValidated,e.ctrl.newDiscussionBodyValidated]),i=async()=>{if(!r()){g.handleError(Se.createUiError(`${Re}: send: not satisfied`));return}const m=await e.ctrl.createDiscussion({pid:e.ctrl.product.id,typeId:Number(e.ctrl.newDiscussionType),title:e.ctrl.newDiscussionTitle,body:e.ctrl.newDiscussionBody,global:!1});if(!m.successful){g.handleErrorStack(m.errorStack,s.failedToCreate());return}if(e.ctrl.newDiscussionImgs.length>0){const d=await e.ctrl.createDiscussionImg({did:m.value.id,imgs:e.ctrl.newDiscussionImgs});if(!d.successful){g.handleErrorStack(d.errorStack,s.failedToCreate());return}}const n=await e.ctrl.listDiscussions({pid:e.ctrl.product.id});if(!n.successful){g.handleErrorStackQuietly(n.errorStack);return}K.add(Z.createSuccess(s.created())),V.pop()};return X(()=>{e.ctrl.listDiscussionTypes().then(m=>{if(!m.successful){g.handleErrorStack(m.errorStack,s.failedToFetchData());return}a.value=[{label:s.pleaseSelect(),value:""},...m.value.map(n=>({label:n.label,value:n.id.toString()}))],e.ctrl.newDiscussionType=a.value[0].value})}),(m,n)=>(c(),h(G,{title:t(s).createDiscussion(),"close-by-btn":!0,onClose:n[7]||(n[7]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[a.value.length>0?(c(),h(vt,{key:0,id:Re+"-type",label:t(s).discussionType(),modelValue:l.ctrl.newDiscussionType,"onUpdate:modelValue":n[0]||(n[0]=d=>l.ctrl.newDiscussionType=d),options:a.value,spec:t(Nt),onValidated:n[1]||(n[1]=d=>l.ctrl.newDiscussionTypeValidated=d)},null,8,["id","label","modelValue","options","spec"])):C("",!0),p(F,{id:Re+"-title",label:t(s).title(),modelValue:l.ctrl.newDiscussionTitle,"onUpdate:modelValue":n[2]||(n[2]=d=>l.ctrl.newDiscussionTitle=d),spec:t(J),onValidated:n[3]||(n[3]=d=>l.ctrl.newDiscussionTitleValidated=d)},null,8,["id","label","modelValue","spec"]),p(Ke,{id:Re+"-body",label:t(s).description(),modelValue:l.ctrl.newDiscussionBody,"onUpdate:modelValue":n[4]||(n[4]=d=>l.ctrl.newDiscussionBody=d),spec:t(qt),onValidated:n[5]||(n[5]=d=>l.ctrl.newDiscussionBodyValidated=d),onInputImgs:n[6]||(n[6]=d=>l.ctrl.newDiscussionImgs=d)},null,8,["id","label","modelValue","spec"]),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!r(),onClick:i},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),$s=B(Vs,[["__scopeId","data-v-d8d58ac6"]]),Vt="edit-discussion-dialog",Ts=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(e.ctrl.discussion.title),r=v(),i=v(e.ctrl.discussion.body),m=v(),n=v(e.ctrl.imgs),d=()=>n.value.length!==e.ctrl.imgs.length||n.value.some((y,k)=>y.url!==e.ctrl.imgs[k].url),o=()=>a.value!==e.ctrl.discussion.title||i.value!==e.ctrl.discussion.body,u=()=>d()||o(),f=()=>!he([r.value,m.value]),S=async()=>{if(!u()||!f())return;if(o()){const k=await e.ctrl.updateDiscussion(e.ctrl.discussion.id,{...a.value!==e.ctrl.discussion.title?{title:a.value}:{},...i.value!==e.ctrl.discussion.body?{body:i.value}:{}});if(!k.successful){g.handleErrorStack(k.errorStack,s.failedToUpdate());return}}if(d()){const k=e.ctrl.imgs.filter(O=>!n.value.some(q=>q.url===O.url)).map(O=>O.id),_=n.value.filter(O=>!e.ctrl.imgs.some(q=>q.url===O.url)).filter(O=>O.src!==void 0),x=await e.ctrl.updateDiscussionImg({did:e.ctrl.discussion.id,toDelete:k,toAppend:_});if(!x.successful){g.handleErrorStack(x.errorStack,s.failedToUpdate());return}}const y=await e.ctrl.listNewerDiscussionEvents();if(!y.successful){g.handleErrorStack(y.errorStack,s.failedToFetchData());return}K.add(Z.createSuccess(s.updated())),V.pop()};return(y,k)=>(c(),h(G,{title:t(s).editDiscussion(),"close-by-btn":!0,onClose:k[5]||(k[5]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(F,{id:Vt+"-title",label:t(s).title(),modelValue:a.value,"onUpdate:modelValue":k[0]||(k[0]=_=>a.value=_),spec:t(J),onValidated:k[1]||(k[1]=_=>r.value=_)},null,8,["id","label","modelValue","spec"]),p(Ke,{id:Vt+"-body",label:t(s).description(),modelValue:i.value,"onUpdate:modelValue":k[2]||(k[2]=_=>i.value=_),imgs:n.value,spec:t(qt),onValidated:k[3]||(k[3]=_=>m.value=_),onInputImgs:k[4]||(k[4]=_=>n.value=_)},null,8,["id","label","modelValue","imgs","spec"]),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!u()||!f(),onClick:S},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),xs=B(Ts,[["__scopeId","data-v-79279fb5"]]),Ds={class:"body"},Os=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v([]),r=v(),i=async m=>{const n=await e.ctrl.switchWs(m);if(!n.successful){g.handleErrorStack(n.errorStack);return}V.pop()};return X(()=>{e.ctrl.getAccount().then(m=>{if(!m.successful){g.handleErrorStack(m.errorStack,s.failedToFetchData());return}r.value=m.value}),e.ctrl.listMyOrgs().then(m=>{if(!m.successful){g.handleErrorStack(m.errorStack,s.failedToFetchData());return}a.value=m.value})}),(m,n)=>(c(),h(G,{title:t(s).selectWorkspace(),onClose:n[1]||(n[1]=()=>t(V).pop())},{default:b(()=>[I("div",Ds,[r.value?(c(),h(qe,{key:0,class:"side-nav__wss__ws__frame__btn",src:r.value.imgUrl,alt:t(s).workspaceOf(r.value.name),size:t(ee).createL(),onClick:n[0]||(n[0]=()=>i(r.value))},null,8,["src","alt","size"])):C("",!0),(c(!0),T(H,null,le(a.value,d=>(c(),h(qe,{key:d.id,class:"side-nav__wss__ws__frame__btn",src:d.imgUrl,alt:t(s).workspaceOf(d.name),size:t(ee).createL(),onClick:()=>i(d)},null,8,["src","alt","size","onClick"]))),128))])]),_:1},8,["title"]))}}),Ns=B(Os,[["__scopeId","data-v-d839b054"]]),qs=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(),r=v(),i=v(!1),m=()=>i.value,n=async()=>{var x,O;if(!a.value){g.handleError(new Error("strp is not set"));return}if(!r.value){g.handleError(new Error("cardElem is not set"));return}const u=await e.ctrl.createPaymentSetupIntent();if(!u.successful){g.handleErrorStack(u.errorStack);return}const{paymentMethod:f,error:S}=await a.value.createPaymentMethod("card",r.value);if(S){g.handleError(S);return}if(!f.card){g.handleError(new Error("paymentMethod.card is not set"),s.failedToUpdate());return}const y=await a.value.confirmCardSetup(u.value.clientSecret,{payment_method:f.id});if(y.error){g.handleError(y.error);return}(x=f.card)!=null&&x.last4;const k=await e.ctrl.createPaymentMethod({id:f.id,ccLast4:((O=f.card)==null?void 0:O.last4)||"****"});if(!k.successful){g.handleErrorStack(k.errorStack,s.failedToUpdate());return}K.add(Z.createSuccess(s.updated()));const _=await e.ctrl.listPaymentMethods();if(!_.successful){g.handleErrorStackQuietly(_.errorStack);return}_.value.forEach(async q=>{if(q.id===k.value.id)return;const w=await e.ctrl.deletePaymentMethod(q);if(!w.successful){g.handleErrorStackQuietly(w.errorStack);return}}),V.pop()},d=async()=>{a.value=Stripe(void 0),r.value=a.value.elements({}).create("card",{hidePostalCode:!0,style:_e.createCardElemStyle(se.isDarkMode)}),r.value.on("change",u=>{i.value=u.complete})},o=u=>{r.value&&r.value.update({style:_e.createCardElemStyle(u)})};return X(()=>{se.subscribeToDarkModeChangeEvent(o),d()}),ie(()=>{se.unsubscribeFromDarkModeChangeEvent(o)}),(u,f)=>(c(),h(G,{title:t(s).changeCc(),"close-by-btn":!0,onClose:f[1]||(f[1]=()=>t(V).pop())},{default:b(()=>[r.value?(c(),h(gt,{key:0,"card-elem":r.value},null,8,["card-elem"])):C("",!0),p(Q,{class:"action"},{default:b(()=>[p(P,{fat:!0,disabled:!m(),onClick:n},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"]),p(P,{theme:t(te).Outlined,fat:!0,onClick:f[0]||(f[0]=()=>t(V).pop())},{default:b(()=>[U($(t(s).cancel()),1)]),_:1},8,["theme"])]),_:1})]),_:1},8,["title"]))}}),Bs=B(qs,[["__scopeId","data-v-b74b8b3f"]]);class As{static roundDown(e,a){const r=Math.pow(10,a);return Math.floor(e*r)/r}static toPriceJpyString(e){return e.toLocaleString(void 0,{style:"currency",currency:"JPY"})}}const Us={class:"container"},Rs={class:"container__info"},Ps={class:"container__info__item"},Ms={class:"container__info__item__label"},Fs={class:"container__info__item__value"},Ls={class:"container__info__item"},zs={class:"container__info__item__label"},Js={class:"container__info__item__value"},Ws=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(),r=v(),i=v(!1),m=()=>i.value,n=async()=>{if(!a.value){g.handleError(new Error("strp is not set"));return}if(!r.value){g.handleError(new Error("cardElem is not set"));return}const u=await a.value.confirmPayment({elements:r.value,confirmParams:{return_url:`https://localhost:3000/billing?${Ut}=${new Date().toISOString()}`}});if(u.error){g.handleError(u.error);return}Ne.debug(u.value),V.pop()},d=async()=>{if(!e.ctrl.bill.paymentIntentClientSecret){g.handleError(new Error("paymentIntentClientSecret is not set"));return}a.value=Stripe(void 0),r.value=a.value.elements({clientSecret:e.ctrl.bill.paymentIntentClientSecret}).create("card",{hidePostalCode:!0,style:_e.createCardElemStyle(se.isDarkMode)}),r.value.on("change",u=>{i.value=u.complete})},o=u=>{r.value&&r.value.update({style:_e.createCardElemStyle(u)})};return X(()=>{se.subscribeToDarkModeChangeEvent(o),d()}),ie(()=>{se.unsubscribeFromDarkModeChangeEvent(o)}),(u,f)=>(c(),h(G,{title:t(s).makePayment(),"close-by-btn":!0,onClose:f[1]||(f[1]=()=>t(V).pop())},{default:b(()=>[I("div",Us,[I("div",Rs,[I("div",Ps,[I("div",Ms,$(t(s).usagePeriod()),1),I("div",Fs,$(t(s).period(l.ctrl.bill.periodFrom,l.ctrl.bill.periodTo)),1)]),I("div",Ls,[I("div",zs,$(t(s).usageFee()),1),I("div",Js,$(t(As).toPriceJpyString(l.ctrl.bill.dueJpy)),1)])]),r.value?(c(),h(gt,{key:0,"card-elem":r.value},null,8,["card-elem"])):C("",!0),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!m(),onClick:n},{default:b(()=>[U($(t(s).pay()),1)]),_:1},8,["disabled"]),p(P,{theme:t(te).Outlined,fat:!0,onClick:f[0]||(f[0]=()=>t(V).pop())},{default:b(()=>[U($(t(s).cancel()),1)]),_:1},8,["theme"])]),_:1})])]),_:1},8,["title"]))}}),js=B(Ws,[["__scopeId","data-v-2229606e"]]),Hs=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v();return X(async()=>{if(!e.ctrl.bill.paymentIntentClientSecret){g.handleError(new Error("paymentIntentClientSecret is not set"));return}if(!e.ctrl.bill.paymentMethodId){g.handleError(new Error("paymentMethodId is not set"));return}a.value=Stripe(void 0);const r=await a.value.confirmPayment({clientSecret:e.ctrl.bill.paymentIntentClientSecret,confirmParams:{payment_method:e.ctrl.bill.paymentMethodId,return_url:`https://localhost:3000/billing?${Ut}=${new Date().toISOString()}`}});if(r.error){g.handleError(r.error);return}Ne.debug(r.value)}),(r,i)=>(c(),h(G,{title:t(s).makePayment(),"close-by-btn":!0,onClose:i[0]||(i[0]=()=>t(V).pop())},null,8,["title"]))}}),Qs=B(Hs,[["__scopeId","data-v-4ac96878"]]),rt="billing-address-edit-dialog",Gs=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v([]),r=v(e.ctrl.ws.billingName||""),i=v(),m=v(e.ctrl.ws.billingCountryId?String(e.ctrl.ws.billingCountryId):""),n=v(),d=v(e.ctrl.ws.billingAddress||""),o=v(),u=()=>r.value!==(e.ctrl.ws.billingName||"")||m.value!==(e.ctrl.ws.billingCountryId?String(e.ctrl.ws.billingCountryId):"")||d.value!==(e.ctrl.ws.billingAddress||""),f=()=>!he([i.value,n.value,o.value]),S=async()=>{const y=await e.ctrl.updateWorkspace({id:e.ctrl.ws.id,billingName:r.value,billingCountryId:Number(m.value),billingAddress:d.value});if(!y.successful){g.handleErrorStack(y.errorStack,s.failedToUpdate());return}K.add(Z.createSuccess(s.updated())),V.pop()};return X(()=>{e.ctrl.listCountries().then(y=>{if(!y.successful){g.handleErrorStack(y.errorStack);return}a.value=y.value.map(k=>({label:k.label,value:String(k.id)}))})}),(y,k)=>(c(),h(G,{title:t(s).editBillingAddress(),"close-by-btn":!0,onClose:k[6]||(k[6]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[p(F,{id:rt+"-name",label:t(s).billingName(),modelValue:r.value,"onUpdate:modelValue":k[0]||(k[0]=_=>r.value=_),spec:t(J),onValidated:k[1]||(k[1]=_=>i.value=_)},null,8,["id","label","modelValue","spec"]),p(vt,{class:"body__form__input",id:rt+"-country",label:t(s).countryOrRegion(),modelValue:m.value,"onUpdate:modelValue":k[2]||(k[2]=_=>m.value=_),spec:t(J),options:a.value,onValidated:k[3]||(k[3]=_=>n.value=_)},null,8,["id","label","modelValue","spec","options"]),p(F,{id:rt+"-address",label:t(s).billingAddress(),modelValue:d.value,"onUpdate:modelValue":k[4]||(k[4]=_=>d.value=_),spec:t(J),onValidated:k[5]||(k[5]=_=>o.value=_)},null,8,["id","label","modelValue","spec"]),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!u()||!f(),onClick:S},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),Ys=B(Gs,[["__scopeId","data-v-1568630d"]]),Xs="edit-long-txts-dialog",Ks=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=()=>e.ctrl.items.some(m=>m.txt!==m.origTxt),r=()=>!he(e.ctrl.items.map(m=>m.validated)),i=async()=>{for(const m of e.ctrl.items)if(m.txt!==m.origTxt){const n=await m.update(m.txt);if(!n.successful){g.handleErrorStack(n.errorStack,s.failedToUpdate());return}}K.add(Z.createSuccess(s.updated())),V.pop()};return(m,n)=>(c(),h(G,{title:t(s).edit(),"close-by-btn":!0,onClose:n[0]||(n[0]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[(c(!0),T(H,null,le(l.ctrl.items,d=>(c(),h(Ke,{id:Xs+"-body",label:d.label,modelValue:d.txt,"onUpdate:modelValue":o=>d.txt=o,spec:t(ea),"allow-imgs":!1,onValidated:o=>d.validated=o},null,8,["id","label","modelValue","onUpdate:modelValue","spec","onValidated"]))),256)),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!a()||!r(),onClick:i},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),Zs=B(Ks,[["__scopeId","data-v-9efb2cca"]]);class Pe{static home(){switch(D.langCode){case A.JA:return"ホーム";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.home: unexpected language code ${D.langCode}`)),"Home"}}static products(){switch(D.langCode){case A.JA:return"プロダクト";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.products: unexpected language code ${D.langCode}`)),"Products"}}static ourStory(e){switch(e){case A.JA:return this.ourStoryInJa();case A.EN:return this.ourStoryInEn();default:switch(D.langCode){case A.JA:return"私たちのストーリー";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.ourStory: unexpected language code ${D.langCode}`)),"Our Story"}}}static ourStoryInEn(){switch(D.langCode){case A.JA:return"私たちのストーリー（英語）";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.ourStoryInEn: unexpected language code ${D.langCode}`)),"Our Story (in English)"}}static ourStoryInJa(){switch(D.langCode){case A.JA:return"私たちのストーリー（日本語）";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.ourStoryInJa: unexpected language code ${D.langCode}`)),"Our Story (in Japanese)"}}static whereWeAre(){switch(D.langCode){case A.JA:return"所在地";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.whereWeAre: unexpected language code ${D.langCode}`)),"Where We Are"}}static preview(){switch(D.langCode){case A.JA:return"プレビュー";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.preview: unexpected language code ${D.langCode}`)),"Preview"}}static stopPreview(){switch(D.langCode){case A.JA:return"プレビューを停止";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.stopPreview: unexpected language code ${D.langCode}`)),"Stop the preview"}}static name(e){switch(e){case A.JA:return this.nameInJa();case A.EN:return this.nameInEn();default:switch(D.langCode){case A.JA:return"名前";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.name: unexpected language code ${D.langCode}`)),"Name"}}}static nameInEn(){switch(D.langCode){case A.JA:return"名前（英語）";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.nameInEn: unexpected language code ${D.langCode}`)),"Name (in English)"}}static nameInJa(){switch(D.langCode){case A.JA:return"名前（日本語）";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.nameInJa: unexpected language code ${D.langCode}`)),"Name (in Japanese)"}}static addLocation(){switch(D.langCode){case A.JA:return"所在地を追加";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.addLocation: unexpected language code ${D.langCode}`)),"Add a location"}}static editLocation(){switch(D.langCode){case A.JA:return"所在地を編集";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.editLocation: unexpected language code ${D.langCode}`)),"Edit a location"}}static editLocations(){switch(D.langCode){case A.JA:return"所在地を編集";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.editLocations: unexpected language code ${D.langCode}`)),"Edit locations"}}static registrationPanelTitle(e){switch(D.langCode){case A.JA:return`ユーザー登録して、${e}にあなたの声を届けましょう`;default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.registrationPanelTitle: unexpected language code ${D.langCode}`)),`Sign up to let ${e} know what you think of their products.`}}static startNewDiscussion(){switch(D.langCode){case A.JA:return"新しい会話を始める";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.startNewDiscussion: unexpected language code ${D.langCode}`)),"Start a new discussion"}}static noDiscussionYet(){switch(D.langCode){case A.JA:return"まだ会話はありません";default:return D.langCode!==A.EN&&g.handleErrorQuietly(new Error(`I18nText.noDiscussionYet: unexpected language code ${D.langCode}`)),"You have no discussion yet"}}}const it="edit-org-location-dialog",er=R({__name:"index",props:{ctrl:{type:Object,required:!0}},setup(l){const e=l,a=v(e.ctrl.items),r=()=>{a.value.push({newNameEn:"",newNameEnValidated:void 0,origNameEn:"",newNameJa:"",newNameJaValidated:void 0,origNameJa:"",newAddress:"",newAddressValidated:void 0,origAddress:""})},i=o=>{a.value.splice(o,1)},m=()=>e.ctrl.items.some(o=>o.newNameEn!==o.origNameEn||o.newNameJa!==o.origNameJa||o.newAddress!==o.origAddress),n=()=>ce(e.ctrl.items.flatMap(o=>[o.newNameEnValidated,o.newNameJaValidated,o.newAddressValidated])),d=async()=>{const o=await e.ctrl.replace({oid:e.ctrl.org.id,items:e.ctrl.items.map(u=>({nameEn:u.newNameEn,nameJa:u.newNameJa,address:u.newAddress}))});if(!o.successful){g.handleErrorStack(o.errorStack,s.failedToUpdate());return}K.add(Z.createSuccess(s.updated())),V.pop()};return(o,u)=>(c(),h(G,{title:t(Pe).editLocations(),"close-by-btn":!0,"no-padding":!0,onClose:u[0]||(u[0]=()=>t(V).pop())},{default:b(()=>[p(re,{class:"form"},{default:b(()=>[(c(!0),T(H,null,le(a.value,(f,S)=>(c(),T("div",{key:S,class:"form__location"},[p(F,{id:`${it}-${S}-name-en`,label:t(Pe).nameInEn(),modelValue:f.newNameEn,"onUpdate:modelValue":y=>f.newNameEn=y,spec:t(J),onValidated:y=>f.newNameEnValidated=y},null,8,["id","label","modelValue","onUpdate:modelValue","spec","onValidated"]),p(F,{id:`${it}-${S}-name-ja`,label:t(Pe).nameInJa(),modelValue:f.newNameJa,"onUpdate:modelValue":y=>f.newNameJa=y,spec:t(J),onValidated:y=>f.newNameJaValidated=y},null,8,["id","label","modelValue","onUpdate:modelValue","spec","onValidated"]),p(F,{id:`${it}-${S}-address`,label:t(s).address(),modelValue:f.newAddress,"onUpdate:modelValue":y=>f.newAddress=y,spec:t(J),onValidated:y=>f.newAddressValidated=y},null,8,["id","label","modelValue","onUpdate:modelValue","spec","onValidated"]),p(Q,{"align-h":t(Ot).Right},{default:b(()=>[p(Dt,{src:"/icon/delete-light-black.svg","dark-src":"/icon/delete-silver.svg",alt:t(s).delete(),onClick:()=>i(S)},null,8,["alt","onClick"])]),_:2},1032,["align-h"])]))),128)),p(Q,null,{default:b(()=>[p(P,{class:"form__add-location","head-icon":{src:"/icon/add-light-black.svg",darkSrc:"/icon/add-light-black.svg",activeSrc:"/icon/add-light-black.svg"},theme:t(te).Text,"text-btn-underline-when":t(Ie).Never,onClick:r},{default:b(()=>[U($(t(Pe).addLocation()),1)]),_:1},8,["theme","text-btn-underline-when"])]),_:1}),p(Q,null,{default:b(()=>[p(P,{fat:!0,disabled:!m()||!n(),onClick:d},{default:b(()=>[U($(t(s).done()),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["title"]))}}),tr=B(er,[["__scopeId","data-v-e0328198"]]),ar=R({__name:"group",setup(l){const e=v([]),a=v(),r=i=>{e.value=i,a.value=i[i.length-1]};return X(()=>{V.subscribeToChangeEvents(r)}),ie(()=>{V.unsubscribeFromChangeEvents(r)}),(i,m)=>(c(!0),T(H,null,le(e.value,(n,d)=>(c(),T(H,{key:d},[n.name===t(L).Confirmation?(c(),h(Nl,{key:0,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).Register?(c(),h(jl,{key:1,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).LogIn?(c(),h(Gl,{key:2,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).CropImg?(c(),h(nn,{key:3,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).PreviewImg?(c(),h(cn,{key:4,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).CreateOrg?(c(),h(Mn,{key:5,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditOrg?(c(),h(Ln,{key:6,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).CreateProduct?(c(),h(ts,{key:7,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditAccount?(c(),h(Xl,{key:8,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).TransformAccount?(c(),h(Zl,{key:9,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditProduct?(c(),h(ls,{key:10,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).CreatePsq?(c(),h(ks,{key:11,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).DeletePsq?(c(),h(Is,{key:12,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).CreateDiscussion?(c(),h($s,{key:13,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditDiscussion?(c(),h(xs,{key:14,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).OrgNewMember?(c(),h(Wn,{key:15,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).OrgDeleteMember?(c(),h(Xn,{key:16,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).SelectWs?(c(),h(Ns,{key:17,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).ChangeCc?(c(),h(Bs,{key:18,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).Pay?(c(),h(js,{key:19,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).ConfirmPayment?(c(),h(Qs,{key:20,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditBillingAddress?(c(),h(Ys,{key:21,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditLongTxts?(c(),h(Zs,{key:22,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0),n.name===t(L).EditOrgLocations?(c(),h(tr,{key:23,ctrl:n,class:"dstack__item","data-active":n===a.value},null,8,["ctrl","data-active"])):C("",!0)],64))),128))}}),lr=B(ar,[["__scopeId","data-v-98595d72"]]),$t=()=>{},nr={key:0,class:"tooltip__inner"},Tt=-100,xt=-100,sr=R({__name:"index",setup(l){const e=v(),a=v(),r=v(Tt),i=v(xt),m=f=>{if(e.value=f,!f){d();return}setTimeout(n)},n=()=>{if(!e.value)return;const f=o();if(!f)return;const{x:S,y,width:k,height:_}=e.value.target.getBoundingClientRect(),x={top:y,right:window.innerWidth-S-k,bottom:window.innerHeight-y-_,left:S};r.value=x.top>f.h||x.top>x.bottom?y-f.h:y+_,i.value=x.right>f.w||x.right>x.left?S+k:S-f.w},d=()=>{r.value=Tt,i.value=xt},o=()=>{if(!a.value)return;const f=a.value.cloneNode(!0);de.appendToTemp(f);const S=f.offsetHeight,y=f.offsetWidth;return de.removeFromTemp(f),{h:S,w:y}},u=()=>{Ze.close()};return X(()=>{window.addEventListener("resize",n),Ze.subscribeToEvents(m),fe.subscribeToBackgroundClickEvent(u)}),ie(()=>{window.removeEventListener("resize",n),Ze.unsubscribeFromEvents(m),fe.unsubscribeFromBackgroundClickEvent(u)}),(f,S)=>(c(),T("div",{class:"tooltip",ref_key:"elem",ref:a,style:be({top:r.value+"px",left:i.value+"px"}),onClick:S[0]||(S[0]=ya((...y)=>t($t)&&t($t)(...y),["stop"]))},[e.value?(c(),T("div",nr,$(e.value.text),1)):C("",!0)],4))}}),rr=B(sr,[["__scopeId","data-v-e8f53539"]]),ir={class:"guest-log-in-banner"},or={class:"guest-log-in-banner__txt"},dr={key:0},cr=R({__name:"guest-log-in",props:{account:{type:Object,required:!0}},setup(l){const e=l,a=v(),r=()=>{V.push(new Ft({account:e.account,requestOtp:Ae.requestOtp,transformUser:ae.transform}))};return X(()=>{xa.get(e.account.wsId).then(i=>{if(!i.successful){g.handleErrorStack(i.errorStack,s.failedToFetchData());return}a.value=i.value})}),(i,m)=>{var n;return c(),T("div",ir,[I("p",or,[I("span",null,$(t(s).loggedInAsGuestUser()),1),U("  "),(n=a.value)!=null&&n.inactiveAfter?(c(),T("span",dr,$(t(s).toKeepThisAccountRegisterFromTheButtonOnTheRightBy(a.value.inactiveAfter)),1)):C("",!0)]),p(P,{class:"block-s",onClick:r},{default:b(()=>[U($(t(s).register()),1)]),_:1}),p(P,{class:"block-td","bit-fat":!0,onClick:r},{default:b(()=>[U($(t(s).register()),1)]),_:1})])}}}),ur=B(cr,[["__scopeId","data-v-eca71ca2"]]),mr=["data-is-guest"],pr=["data-animate-padding"],vr=["data-has-bottom-btn","data-no-padding"],gr=R({__name:"index",props:{zenRightBar:{type:Boolean,required:!1,default:!1},showWatermark:{type:Boolean,required:!1,default:!1},noPadding:{type:Boolean,required:!1,default:!1},hideHeaderBorder:{type:Boolean,required:!1,default:!1},finiteMainContainerHeight:{type:Boolean,required:!1,default:!1},hasBottomBtn:{type:Boolean,required:!1,default:!1}},setup(l){const e=v(),a=v(null),r=v(!1),i=u=>{a.value&&a.value.scrollTo({top:a.value.scrollHeight,behavior:"smooth"})};X(()=>{ae.getAccount().then(u=>{if(!u.successful){g.handleErrorStack(u.errorStack,s.failedToFetchData());return}e.value=u.value}),window.addEventListener("resize",n),fe.subscribeToMainContainerScrollRequestEvent(i)}),ie(()=>{window.removeEventListener("resize",n),fe.unsubscribeFromMainContainerScrollRequestEvent(i)});const m=u=>{u.preventDefault(),u.dataTransfer&&(u.dataTransfer.dropEffect="none"),fe.publishSidePanelWidthUpdateEvent(de.calcSidePanelWidth(u))},n=()=>{Te.isDesktop(window)||yt.sidePanelWidthPx!==null&&yt.sidePanelWidthPx>window.innerWidth&&fe.publishSidePanelWidthUpdateEvent(window.innerWidth)},d=u=>{fe.publishBackgroundClickEvent(u)},o=u=>{e.value=u};return X(()=>{ae.subscribeToAccountChangeEvent(o)}),ie(()=>{ae.unsubscribeFromAccountChangeEvent(o)}),(u,f)=>(c(),T("div",{class:"app-frame","data-is-guest":e.value&&e.value.isGuest,onClick:d},[e.value&&e.value.isGuest?(c(),h(ur,{key:0,account:e.value},null,8,["account"])):C("",!0),p(tl,{"data-is-guest":e.value&&e.value.isGuest},null,8,["data-is-guest"]),e.value?(c(),h(Ra,{key:1,account:e.value},null,8,["account"])):C("",!0),I("div",{class:"app-frame__main","data-animate-padding":r.value,style:{}},[I("main",{id:"app-frame-main-container",class:"app-frame__main__container","data-has-bottom-btn":l.hasBottomBtn,"data-no-padding":l.noPadding,ref_key:"scrollElem",ref:a,onDragover:m},[At(u.$slots,"default",{},void 0,!0)],40,vr),l.showWatermark?(c(),h(la,{key:0,class:"app-frame__watermark"})):C("",!0)],8,pr),p(Vl,{class:"app-frame__right-bar",zen:l.zenRightBar},null,8,["zen"]),p(lr),p(ta),p(rr),p(aa)],8,mr))}}),kr=B(gr,[["__scopeId","data-v-f01006ee"]]);export{kr as A,Q as B,Mt as C,As as N,ct as P,zn as S,nl as T,pt as a,Ce as b,Pt as c,mt as d,Fa as l,dt as s};
